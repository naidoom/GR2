(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    229788,       6092]
NotebookOptionsPosition[    224302,       5912]
NotebookOutlinePosition[    224738,       5929]
CellTagsIndexPosition[    224695,       5926]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "This", " ", "document", " ", "is", " ", "based", " ", "primarily", " ", 
      "on", " ", "\[IndentingNewLine]", "Nonlinear", " ", "water", " ", 
      "waves", " ", "propagating", " ", "over", " ", "a", " ", "permeable", 
      " ", "bed", "\n", "Shih"}], "-", 
     RowBox[{"Chun", " ", "Hsiao"}]}], ",", 
    RowBox[{"Philip", " ", 
     RowBox[{"L", ".", 
      RowBox[{"-", 
       RowBox[{"F", ".", "Liu"}]}]}], " ", "and", " ", "Yongze", " ", "Chen", 
     "\n", 
     RowBox[{"Proc", ".", "R", ".", "Soc", ".", "Lond", ".", "A"}], " ", 
     "2002", " ", "458"}], ",", 
    RowBox[{"doi", ":", 
     RowBox[{
      RowBox[{"10.1098", "/", "rspa"}], ".2001", ".0903"}]}], ",", 
    RowBox[{"published", " ", "8", " ", "June", " ", "2002"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Definitions", ":", "\[IndentingNewLine]", "a0"}], " ", "=", " ", 
    
    RowBox[{
     RowBox[{
     "characteristic", " ", "wave", " ", "height", "\[IndentingNewLine]", 
      "h0"}], " ", "=", " ", 
     RowBox[{
      RowBox[{
      "characteristic", " ", "wave", " ", "depth", "\[IndentingNewLine]", 
       "l0"}], " ", "=", " ", 
      RowBox[{
      "characteristic", " ", "wave", " ", "length", "\[IndentingNewLine]", 
       "mu", " ", "and", " ", "eps", " ", "are", " ", "small", " ", 
       "parameters"}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"a0", " ", ":=", " ", 
    RowBox[{"eps", " ", "h0"}]}], ";", 
   RowBox[{"h0", " ", ":=", " ", 
    RowBox[{"mu", " ", "l0"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6079675066867323`*^9, 3.607967511216264*^9}, {
  3.607967611472067*^9, 3.6079676120811157`*^9}, {3.608479823648553*^9, 
  3.608479842901648*^9}, {3.6368124779809504`*^9, 3.636812562456376*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "rule", " ", "converts", " ", "coordinates", " ", "of", " ", 
     "functions"}], ",", " ", 
    RowBox[{
    "as", " ", "well", " ", "as", " ", "derivatives", " ", "of", 
     "\[IndentingNewLine]", "those", " ", "funtions"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ConvertToDimensionlessRules", " ", "=", " ", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"u", " ", "\[Rule]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{
            RowBox[{"#1", "/", "l0"}], ",", 
            RowBox[{"#2", "/", "l0"}], ",", 
            RowBox[{"#3", "/", "h0"}], ",", 
            RowBox[{"#4", " ", 
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"g", " ", "h0"}], "]"}], "/", "l0"}]}]}], "]"}], " ", 
          "eps", " ", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"g", " ", "h0"}], "]"}]}], " ", "&"}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"v", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{
            RowBox[{"#1", "/", "l0"}], ",", 
            RowBox[{"#2", "/", "l0"}], ",", 
            RowBox[{"#3", "/", "h0"}], ",", 
            RowBox[{"#4", " ", 
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"g", " ", "h0"}], "]"}], "/", "l0"}]}]}], "]"}], " ", 
          "eps", " ", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"g", " ", "h0"}], "]"}]}], "&"}], ")"}]}], ",", 
      RowBox[{"w", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{
            RowBox[{"#1", "/", "l0"}], ",", 
            RowBox[{"#2", "/", "l0"}], ",", 
            RowBox[{"#3", "/", "h0"}], ",", 
            RowBox[{"#4", " ", 
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"g", " ", "h0"}], "]"}], "/", "l0"}]}]}], "]"}], " ", 
          RowBox[{"eps", "/", "mu"}], " ", 
          RowBox[{"(", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"g", " ", "h0"}], "]"}], ")"}]}], "&"}], ")"}]}], ",", 
      RowBox[{"p", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{
             RowBox[{"#1", "/", "l0"}], ",", 
             RowBox[{"#2", "/", "l0"}], ",", 
             RowBox[{"#3", "/", "h0"}], ",", 
             RowBox[{"#4", " ", 
              RowBox[{
               RowBox[{"Sqrt", "[", 
                RowBox[{"g", " ", "h0"}], "]"}], "/", "l0"}]}]}], "]"}], "/", 
           "rho"}], " ", "g", " ", "a0"}], "&"}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"h", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"h0", " ", 
          RowBox[{"h", "[", 
           RowBox[{
            RowBox[{"#1", "/", "l0"}], ",", 
            RowBox[{"#2", "/", "l0"}]}], "]"}]}], " ", "&"}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "The", " ", "coefficient", " ", "for", " ", "zeta", " ", "was", " ", 
        "inferred", " ", "from", " ", "Hsaio", " ", "Eqn", " ", 
        RowBox[{"2.12", ".", " ", "The"}], " ", "h0", " ", "is", " ", 
        "needed", " ", "to", " ", "make", " ", "it", " ", 
        RowBox[{"dimensionless", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"zeta", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"eps", " ", "h0", " ", 
          RowBox[{"zeta", "[", 
           RowBox[{
            RowBox[{"#1", "/", "l0"}], ",", 
            RowBox[{"#2", "/", "l0"}], ",", 
            RowBox[{"#3", " ", 
             RowBox[{
              RowBox[{"Sqrt", "[", 
               RowBox[{"g", " ", "h0"}], "]"}], "/", "l0"}]}]}], "]"}]}], 
         "&"}], ")"}]}]}], "\n", "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.607967811823593*^9, 3.607967928621394*^9}, {
   3.6079693445560923`*^9, 3.607969395685446*^9}, {3.608027332320999*^9, 
   3.608027332741205*^9}, {3.608027463748477*^9, 3.608027493244388*^9}, {
   3.60802755427127*^9, 3.608027588802413*^9}, {3.608028522690632*^9, 
   3.6080285238897753`*^9}, {3.608028563537092*^9, 3.6080285736588593`*^9}, 
   3.6086511520475082`*^9, {3.609839494363305*^9, 3.6098395081679153`*^9}, {
   3.6098395994258966`*^9, 3.609839599792754*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"It", " ", "looks", " ", "ugly", " ", "to", " ", "see", " ", 
     RowBox[{"x", "/", "l0"}], " ", "in", " ", "slot", " ", "one", " ", 
     "instead", " ", "of", " ", 
     RowBox[{"x", ".", " ", "This"}], " ", "will", " ", "allow", " ", "you", 
     " ", "to", " ", "convert", " ", "back", " ", "after", " ", "getting", 
     " ", "all", " ", "the", " ", "derivatives", " ", 
     RowBox[{"changed", ".", " ", "Conceptually"}]}], ",", " ", 
    RowBox[{"these", " ", "new", " ", "x"}], ",", "y", ",", 
    RowBox[{
    "z", " ", "coords", " ", "are", " ", "different", " ", "from", " ", "the",
      " ", "old", " ", "but", " ", "we", " ", "use", " ", "the", " ", "same", 
     " ", 
     RowBox[{"letters", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NormalizeCoordinates", " ", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "\[Rule]", 
       RowBox[{"x", " ", "l0"}]}], ",", 
      RowBox[{"y", "\[Rule]", 
       RowBox[{"y", " ", "l0"}]}], ",", 
      RowBox[{"z", "\[Rule]", 
       RowBox[{"z", " ", "h0"}]}], ",", 
      RowBox[{"t", "\[Rule]", 
       RowBox[{"l0", " ", 
        RowBox[{"t", "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"g", " ", "h0"}], "]"}]}]}]}]}], "}"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.6079692368186817`*^9, 3.607969250813446*^9}, {
  3.6079694611352577`*^9, 3.607969538825926*^9}, {3.608651999931219*^9, 
  3.6086520223650093`*^9}},
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MassConservationEquation", "  ", "=", " ", 
  RowBox[{"Div", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], ",", 
      RowBox[{"v", "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], ",", 
      RowBox[{"w", "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6079679501495934`*^9, 3.607967958793043*^9}, {
  3.607968625802096*^9, 3.607968686630981*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["w", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "+", 
  RowBox[{
   SuperscriptBox["v", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "+", 
  RowBox[{
   SuperscriptBox["u", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGAwB+J/bixlyx++coyZMGkliE7ynzdjBZAWWRsfehhI7/14
+ofHo1eOXgWX2WYC6QhN314Q7ddudXcOkL4mncW7EEgrRmlOOguknZizgs8D
6WPrr98H0VO13wq8AtKv1ixc+gZIZ8u+X/EFSAe4Rjl/efzK8dTWhKUgOrpr
9QYQfVnxp9dXIN3g/Gei4JNXjikqV0qlgTR7560zILrTf990i6evHNt2r/nL
8eyVY8Z5hZNmz185PiiIkcl4+crxxOFzGiC6SH/B2htAuspq11cQPVn6IOe2
V68cty7bJWvN+tqxdO/PABsgHS7SKm0LpJ9EzA1yBNKdB5X2pgFprklzXmUD
6Q1NRk4tQHpFyutiED3N0F9pIki9yPF5IPpO7WKhSUDaLfFk+nq2145f2J+W
x7C/dpz3853odSA9Ye4EpRtAms37w1x17teOOQ8z5X8B6f1X/rYc4QPaI8e5
yYv/taPtFWaZBQKvHfWmCOvtB9J7Nkt6XBF77WgiIB7xAEgLSvlUrJZ47Vg0
LfUwiAYAKFvpCw==
  "],
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Hsaiao", " ", "2002"}], ",", " ", 
    RowBox[{"Eqn", " ", "2.6"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MassEqn", "=", 
     RowBox[{
      RowBox[{
      "MassConservationEquation", " ", "/.", " ", 
       "ConvertToDimensionlessRules"}], " ", "/.", " ", 
      "NormalizeCoordinates"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MassFinal", " ", "=", " ", 
    RowBox[{"Expand", "[", 
     RowBox[{"MassEqn", "/", 
      RowBox[{"Coefficient", "[", 
       RowBox[{
        RowBox[{"Expand", "[", "MassEqn", "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"w", "[", 
           RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], ",", "z"}], 
         "]"}]}], "]"}]}], "]"}], " "}]}]}]], "Input",
 CellChangeTimes->{{3.607969166385231*^9, 3.6079691951000767`*^9}, {
   3.6079692567000732`*^9, 3.6079692770446053`*^9}, {3.6079700553341722`*^9, 
   3.607970087679886*^9}, 3.608652117001864*^9},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["w", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "+", 
  RowBox[{
   SuperscriptBox["mu", "2"], " ", 
   RowBox[{
    SuperscriptBox["v", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["mu", "2"], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.6079691971373587`*^9, {3.607969262037403*^9, 3.607969278141521*^9}, 
   3.6079700928874273`*^9, 3.607971012984356*^9, 3.608025771011195*^9, 
   3.608299462403264*^9, 3.6084634146562*^9, 3.608464490441265*^9, 
   3.608471273864943*^9, 3.6084798513493*^9, 3.608571025322425*^9, 
   3.608574619335005*^9, 3.608575742762883*^9, 3.60862938343832*^9, 
   3.608634669078929*^9, 3.608651079521614*^9, 3.609174554849245*^9, 
   3.6091753390441837`*^9, 3.609175429381216*^9, 3.609176663810601*^9, 
   3.609234575901664*^9, 3.6092548307179003`*^9, 3.6092555268964357`*^9, 
   3.6098387819881077`*^9, 3.61026558164434*^9, 3.610883657288829*^9, 
   3.612033250926*^9, 3.612033350485984*^9, 3.6122637890472603`*^9, 
   3.612264365851314*^9, 3.612717134076436*^9, 3.626621165868355*^9, 
   3.626623623829446*^9, 3.62662524419905*^9, 3.626633876940571*^9, 
   3.626710505118772*^9, 3.626721108932609*^9, 3.626770961664152*^9, 
   3.6267713593995*^9, 3.626797330514491*^9, 3.626798326307995*^9, 
   3.626799253175467*^9, 3.62738361433364*^9, 3.627738047217291*^9, 
   3.6279891675195293`*^9, 3.62799131658038*^9, 3.6297269595469418`*^9, 
   3.630158075370998*^9, 3.631621159979558*^9, 3.6318959523439417`*^9, 
   3.632595168170147*^9, 3.632658800701007*^9, 3.635847744845026*^9, 
   3.635872448773942*^9, 3.6368127384358664`*^9, 3.636813339215765*^9},
 FontSize->14]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Create", " ", "a", " ", "rule", " ", "to", " ", "eliminate", " ", "w_z", 
    " ", "from", " ", "an", " ", "equation"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MassRule", " ", "=", " ", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"MassFinal", " ", "\[Equal]", " ", "0"}], ",", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"w", "[", 
          RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], ",", "z"}], 
        "]"}]}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.608025760926292*^9, 3.6080258298192587`*^9}},
 FontSize->14],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"Coords", ",", "Uvec"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coords", ":=", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Uvec", " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], ",", 
     RowBox[{"v", "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], ",", 
     RowBox[{"w", "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.607969623198139*^9, 3.6079696321024723`*^9}, {
  3.607969712013115*^9, 3.607969758353904*^9}, {3.607970318200844*^9, 
  3.60797033063144*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"From", " ", "the", " ", "Euler", " ", 
    RowBox[{"Eqns", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MomentumEquation", "[", "j_", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"Uvec", ",", "t"}], "]"}], "+", 
        RowBox[{"Grad", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Uvec", ".", "Uvec"}], "/", "2"}], ",", "Coords"}], "]"}], 
        "+", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"Curl", "[", 
           RowBox[{"Uvec", ",", "Coords"}], "]"}], ",", "Uvec"}], "]"}]}], 
       ")"}], "[", 
      RowBox[{"[", "j", "]"}], "]"}], "+", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "+", 
        RowBox[{"g", " ", "z"}]}], ",", 
       RowBox[{"Coords", "[", 
        RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.607969587001439*^9, 3.607969616076442*^9}, {
   3.607969667731401*^9, 3.607969695487906*^9}, {3.6079697670895357`*^9, 
   3.607969847139502*^9}, {3.607970336737556*^9, 3.60797037920359*^9}, {
   3.609838886959012*^9, 3.609838894541191*^9}, {3.62663382349853*^9, 
   3.6266338669048223`*^9}, {3.626633983182189*^9, 3.626634005361824*^9}, 
   3.626634067722269*^9, {3.626710700652426*^9, 3.62671070231006*^9}, 
   3.6368126686474667`*^9},
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Hsaiao", " ", "2002"}], ",", " ", 
    RowBox[{"Eqn", " ", 
     RowBox[{"2.7", ".", " ", "We"}], " ", "use", " ", "the", " ", "MassRule",
      " ", "to", " ", "eliminate", " ", "w_z"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Mom1", " ", "=", 
     RowBox[{"Expand", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"MomentumEquation", "[", "1", "]"}], "/.", " ", 
         "ConvertToDimensionlessRules"}], " ", "/.", " ", 
        "NormalizeCoordinates"}], " ", "/.", " ", "MassRule"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Mom1Final", " ", "=", " ", 
    RowBox[{"Expand", "[", 
     RowBox[{"Mom1", "/", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"Mom1", ",", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], ",", "t"}], 
         "]"}]}], "]"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.607969849938731*^9, 3.607970046596778*^9}, 
   3.60797010084142*^9, {3.608025846894898*^9, 3.608025849129552*^9}, {
   3.608026750285475*^9, 3.6080267614104424`*^9}, 3.626633927574806*^9, {
   3.626633966811816*^9, 3.6266339741837997`*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["u", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "+", 
  FractionBox[
   RowBox[{"eps", " ", 
    RowBox[{"w", "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], 
   SuperscriptBox["mu", "2"]], "+", 
  RowBox[{"eps", " ", 
   RowBox[{"v", "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["p", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "rho"], "+", 
  RowBox[{"eps", " ", 
   RowBox[{"u", "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["u", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.6079699685859833`*^9, 3.607969990709029*^9}, 
   3.6079700343111057`*^9, 3.6079701018466873`*^9, 3.607970399938364*^9, {
   3.60797099793183*^9, 3.6079710382175303`*^9}, 3.6080258524101677`*^9, 
   3.608299462459488*^9, 3.6084634147655973`*^9, 3.6084644904882193`*^9, 
   3.608471273925605*^9, 3.608479851395831*^9, 3.608571025512155*^9, 
   3.608574619375896*^9, 3.608575742800166*^9, 3.608629383640606*^9, 
   3.608634669117524*^9, 3.608651079626265*^9, 3.609174554905095*^9, 
   3.609175339136791*^9, 3.609175429474909*^9, 3.609176663854106*^9, 
   3.6092345759327583`*^9, 3.609254830849925*^9, 3.609255526948021*^9, 
   3.6098387821977262`*^9, 3.6102655817801733`*^9, 3.610883657514835*^9, 
   3.6120332511693897`*^9, 3.6120333505803757`*^9, 3.612263789346904*^9, 
   3.612264365897439*^9, 3.6127171343087187`*^9, 3.626621165917101*^9, 
   3.62662362386905*^9, 3.626625244260062*^9, 3.626633886218766*^9, 
   3.626633928504362*^9, 3.626634009149344*^9, 3.62663407744658*^9, 
   3.626710505221109*^9, 3.6267211090075817`*^9, 3.6267709617946863`*^9, 
   3.626771359458948*^9, 3.626797330690205*^9, 3.626798326367651*^9, 
   3.626799253345231*^9, 3.627383614453096*^9, 3.627738047470366*^9, 
   3.627989167791874*^9, 3.627991316688727*^9, 3.6297269597886257`*^9, 
   3.6301580755202208`*^9, 3.6316211601211987`*^9, 3.631895952502264*^9, 
   3.632595168308848*^9, 3.632658800899702*^9, 3.635847745105239*^9, 
   3.635872448910603*^9, 3.636812738602219*^9, 3.636813339290656*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Mom2", " ", "=", 
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MomentumEquation", "[", "2", "]"}], "/.", " ", 
       "ConvertToDimensionlessRules"}], " ", "/.", " ", 
      "NormalizeCoordinates"}], " ", "/.", " ", "MassRule"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Mom2Final", " ", "=", " ", 
  RowBox[{"Expand", "[", 
   RowBox[{"Mom2", "/", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"Mom2", ",", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], ",", "t"}], 
       "]"}]}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.607970114288802*^9, 3.607970126016736*^9}, {
  3.607971033835281*^9, 3.6079710339535437`*^9}, {3.608025858596385*^9, 
  3.608025860903213*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["v", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "+", 
  FractionBox[
   RowBox[{"eps", " ", 
    RowBox[{"w", "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["v", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], 
   SuperscriptBox["mu", "2"]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["p", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "rho"], "+", 
  RowBox[{"eps", " ", 
   RowBox[{"v", "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["v", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "+", 
  RowBox[{"eps", " ", 
   RowBox[{"u", "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["v", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.607970127328418*^9, 3.60797040345572*^9, {3.6079709981176558`*^9, 
   3.607971034625071*^9}, 3.608025861323462*^9, 3.6082994624898252`*^9, 
   3.608463414811267*^9, 3.608464490517797*^9, 3.608471273959856*^9, 
   3.608479851424567*^9, 3.608571025614246*^9, 3.608574619398333*^9, 
   3.608575742818967*^9, 3.6086293836723413`*^9, 3.608634669141018*^9, 
   3.608651079661227*^9, 3.609174554936986*^9, 3.609175339161872*^9, 
   3.609175429497382*^9, 3.609176663876524*^9, 3.609234575948372*^9, 
   3.609254830925892*^9, 3.609255526982771*^9, 3.60983878223278*^9, 
   3.610265581797781*^9, 3.610883657542183*^9, 3.6120332512050047`*^9, 
   3.612033350607939*^9, 3.612263789383871*^9, 3.612264365928135*^9, 
   3.612717134353187*^9, 3.626621165951571*^9, 3.6266236238946323`*^9, 
   3.626625244294406*^9, 3.6266340164507513`*^9, 3.626634077514038*^9, 
   3.6267105052518578`*^9, 3.626721109048109*^9, 3.626770961872023*^9, 
   3.626771359495372*^9, 3.626797330738912*^9, 3.626798326394946*^9, 
   3.626799253376111*^9, 3.627383614500786*^9, 3.6277380475206137`*^9, 
   3.627989167831567*^9, 3.6279913167226057`*^9, 3.629726959835072*^9, 
   3.630158075585021*^9, 3.63162116017976*^9, 3.631895952588017*^9, 
   3.632595168365725*^9, 3.632658800984434*^9, 3.635847745153666*^9, 
   3.635872448983198*^9, 3.6368127386904087`*^9, 3.6368133393463*^9},
 FontSize->14]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Uvec2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], ",", 
     RowBox[{"v", "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Coords2", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", "y"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "gives", " ", "us", " ", "a", " ", "way", " ", "to", " ", 
    "express", " ", "things", " ", "like", " ", 
    RowBox[{"(", 
     RowBox[{"u", " ", ".", " ", "Grad"}], ")"}], " ", "u"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DotGrad", "[", 
   RowBox[{"a_", ",", "b_", ",", "x_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"[", "i", "]"}], "]"}], " ", 
     RowBox[{"D", "[", 
      RowBox[{"b", ",", 
       RowBox[{"x", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D2", "[", "arg_", "]"}], " ", ":=", " ", 
   RowBox[{"Div", "[", 
    RowBox[{"arg", ",", "Coords2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G2", "[", "arg_", "]"}], " ", ":=", " ", 
   RowBox[{"Grad", "[", 
    RowBox[{"arg", ",", "Coords2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DG2", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], " ", ":=", " ", 
  RowBox[{"DotGrad", "[", 
   RowBox[{"a", ",", "b", ",", "Coords2"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6079705804417458`*^9, 3.607970646199842*^9}, {
   3.607970827250996*^9, 3.607970867734454*^9}, {3.607970900618228*^9, 
   3.607970917686904*^9}, {3.608026086214522*^9, 3.608026108657816*^9}, {
   3.608464376536778*^9, 3.6084643878241262`*^9}, {3.608487573265397*^9, 
   3.608487610466044*^9}, 3.612033331484951*^9},
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Now", " ", "we", " ", "type", " ", "in", " ", "Hsaiao", " ", "Eqn", " ", 
    "2.7", " ", "exactly", " ", "as", " ", "it", " ", "appears", " ", "in", 
    " ", "the", " ", "text", " ", "and", " ", 
    RowBox[{"subtract", ".", " ", "We"}], " ", "should", " ", "get", " ", 
    "0."}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Eqn2p7", "=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"Uvec2", ",", "t"}], "]"}], "+", " ", 
    RowBox[{"eps", " ", 
     RowBox[{"DG2", "[", 
      RowBox[{"Uvec2", ",", "Uvec2"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"eps", "/", 
       RowBox[{"mu", "^", "2"}]}], ")"}], " ", 
     RowBox[{"w", "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
     RowBox[{"D", "[", 
      RowBox[{"Uvec2", ",", "z"}], "]"}]}], "+", 
    RowBox[{"G2", "[", 
     RowBox[{
      RowBox[{"p", "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "/", "rho"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.607970492743325*^9, 3.6079704959792843`*^9}, {
  3.607970529871049*^9, 3.6079705552152853`*^9}, {3.6079706524557056`*^9, 
  3.6079707017331667`*^9}, {3.6079707344711246`*^9, 3.6079708761768427`*^9}, {
  3.607970936292227*^9, 3.607970961297735*^9}, {3.607971098181684*^9, 
  3.607971099764159*^9}, {3.60797119959007*^9, 3.607971207426754*^9}, {
  3.607971347490012*^9, 3.60797134775331*^9}, {3.608025968938801*^9, 
  3.60802597048667*^9}, {3.60802600205713*^9, 3.608026059693141*^9}, {
  3.608464398347783*^9, 3.608464404526882*^9}, {3.6098390520642147`*^9, 
  3.609839056837329*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["u", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "+", 
    FractionBox[
     RowBox[{"eps", " ", 
      RowBox[{"w", "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["u", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], 
     SuperscriptBox["mu", "2"]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["p", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "rho"], "+", 
    RowBox[{"eps", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["u", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["u", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}]}], ")"}]}]}], 
   ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["v", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "+", 
    FractionBox[
     RowBox[{"eps", " ", 
      RowBox[{"w", "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["v", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], 
     SuperscriptBox["mu", "2"]], "+", 
    FractionBox[
     RowBox[{
      SuperscriptBox["p", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "rho"], "+", 
    RowBox[{"eps", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["v", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["v", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}]}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.607970496623622*^9, {3.6079707749995623`*^9, 3.607970803433557*^9}, {
   3.607970851403942*^9, 3.60797092069024*^9}, 3.6079709623688307`*^9, 
   3.607971013142438*^9, 3.607971101736004*^9, 3.607971213746209*^9, 
   3.6079713481459417`*^9, 3.608025870248777*^9, 3.6080259711154947`*^9, 
   3.60802600403682*^9, 3.608299462527808*^9, 3.608463414865078*^9, 
   3.6084644053601723`*^9, 3.6084644905526323`*^9, 3.608471274000639*^9, 
   3.608479851461647*^9, 3.608571025653907*^9, 3.608574619427534*^9, 
   3.6085757428434477`*^9, 3.608629383708866*^9, 3.6086346691686373`*^9, 
   3.608651079702991*^9, 3.609174554977726*^9, 3.609175339191277*^9, 
   3.6091754295253363`*^9, 3.60917666390827*^9, 3.609234575967905*^9, 
   3.609254831087051*^9, 3.609255527026355*^9, 3.6098387822719593`*^9, 
   3.6098390576845827`*^9, 3.610265581830155*^9, 3.6108836575754013`*^9, 
   3.612033251241632*^9, 3.6120333506416073`*^9, 3.612263789425495*^9, 
   3.612264365965128*^9, 3.61271713438933*^9, 3.626621165989706*^9, 
   3.626623623927936*^9, 3.626625244337097*^9, 3.6266340293226547`*^9, 
   3.626634077582234*^9, 3.626710505287691*^9, 3.6267211090921173`*^9, 
   3.6267709619302483`*^9, 3.6267713595407763`*^9, 3.626797330800653*^9, 
   3.626798326426038*^9, 3.626799253411128*^9, 3.627383614544196*^9, 
   3.6277380475706043`*^9, 3.627989167873913*^9, 3.6279913167649527`*^9, 
   3.62972695987923*^9, 3.6301580756430807`*^9, 3.6316211602856483`*^9, 
   3.63189595266705*^9, 3.632595168427413*^9, 3.632658801087809*^9, 
   3.635847745221787*^9, 3.635872449045402*^9, 3.636812738768948*^9, 
   3.636813339399105*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"Eqn2p7", "-", 
   RowBox[{"{", 
    RowBox[{"Mom1Final", ",", "Mom2Final"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.607970969714746*^9, 3.6079709845911207`*^9}, {
  3.607971323470158*^9, 3.607971358363765*^9}, {3.6080260097964697`*^9, 
  3.608026019366004*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.6079709850181704`*^9, 3.607971042577223*^9}, 
   3.60797110486033*^9, 3.607971216850279*^9, {3.607971335473034*^9, 
   3.6079713589526033`*^9}, 3.6080258788559427`*^9, 3.608025973994671*^9, {
   3.608026006578076*^9, 3.608026019970092*^9}, 3.608299462559017*^9, 
   3.60846341486957*^9, 3.608464490556521*^9, 3.60847127400486*^9, 
   3.60847985149069*^9, 3.608571025659875*^9, 3.608574619455863*^9, 
   3.6085757428475113`*^9, 3.608629383714695*^9, 3.608634669172333*^9, 
   3.608651079739188*^9, 3.609174554988377*^9, 3.6091753392014*^9, 
   3.609175429545595*^9, 3.60917666391675*^9, 3.6092345759808607`*^9, 
   3.6092548310949163`*^9, 3.609255527034115*^9, 3.609838782300871*^9, 
   3.609839061757305*^9, 3.6102655818479433`*^9, 3.6108836575851507`*^9, 
   3.612033251248232*^9, 3.612033350646881*^9, 3.612263789451551*^9, 
   3.612264365969503*^9, 3.612717134395936*^9, 3.626621165993676*^9, 
   3.626623623933002*^9, 3.626625244341358*^9, 3.626634035060848*^9, 
   3.626634077586153*^9, 3.626710505293584*^9, 3.626721109097166*^9, 
   3.626770961934258*^9, 3.626771359544895*^9, 3.626797330809155*^9, 
   3.626798326430229*^9, 3.626799253415264*^9, 3.627383614549938*^9, 
   3.627738047580123*^9, 3.627989167882337*^9, 3.6279913167735853`*^9, 
   3.629726959886615*^9, 3.630158075648147*^9, 3.6316211602940683`*^9, 
   3.631895952670912*^9, 3.632595168433815*^9, 3.632658801092123*^9, 
   3.635847745230599*^9, 3.6358724490496073`*^9, 3.6368127387729387`*^9, 
   3.636813339403987*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mom3Final", " ", "=", " ", 
  RowBox[{"Expand", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MomentumEquation", "[", "3", "]"}], "/", "g"}], " ", "/.", 
      "ConvertToDimensionlessRules"}], " ", "/.", " ", 
     "NormalizeCoordinates"}], " ", ")"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.608026149059278*^9, 3.608026214721076*^9}, {
   3.608026441796321*^9, 3.608026467894681*^9}, {3.608026587166032*^9, 
   3.608026733081509*^9}, {3.609839086064869*^9, 3.6098390982881727`*^9}, {
   3.62663416187893*^9, 3.626634162222431*^9}, 3.6368127298531523`*^9, {
   3.636812799156048*^9, 3.636812824272832*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{"eps", " ", 
   RowBox[{
    SuperscriptBox["w", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "+", 
  FractionBox[
   RowBox[{"eps", " ", 
    RowBox[{
     SuperscriptBox["p", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "rho"], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["eps", "2"], " ", 
    RowBox[{"w", "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["w", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], 
   SuperscriptBox["mu", "2"]], "+", 
  RowBox[{
   SuperscriptBox["eps", "2"], " ", 
   RowBox[{"v", "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["w", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["eps", "2"], " ", 
   RowBox[{"u", "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
   RowBox[{
    SuperscriptBox["w", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.608026154393078*^9, 3.6080262155872383`*^9}, {
   3.608026442404275*^9, 3.608026468356832*^9}, {3.608026620201743*^9, 
   3.608026696852386*^9}, 3.608026734116171*^9, 3.60829946258987*^9, 
   3.6084634149194107`*^9, 3.608464490588088*^9, 3.608471274041912*^9, 
   3.6084798515174017`*^9, 3.608571025689*^9, 3.608574619479747*^9, 
   3.608575742867777*^9, 3.608629383744401*^9, 3.608634669196618*^9, 
   3.608651079776905*^9, 3.609174555023094*^9, 3.609175339224319*^9, 
   3.609175429564392*^9, 3.6091766639440117`*^9, 3.609234575996251*^9, 
   3.609254831190782*^9, 3.609255527072185*^9, 3.6098387823304853`*^9, 
   3.609839103235358*^9, 3.6102655818651323`*^9, 3.610883657610154*^9, 
   3.612033251277186*^9, 3.612033350678059*^9, 3.612263789477791*^9, 
   3.612264366000551*^9, 3.6127171344245768`*^9, 3.626621166028728*^9, 
   3.626623623961176*^9, 3.626625244376419*^9, 3.626634092064252*^9, 
   3.6266341633350973`*^9, 3.626710505325295*^9, 3.626721109135338*^9, 
   3.6267709619866323`*^9, 3.6267713596167803`*^9, 3.6267973308516197`*^9, 
   3.626798326461775*^9, 3.6267992534516363`*^9, 3.6273836145838947`*^9, 
   3.627738047621079*^9, 3.627989167920169*^9, 3.627991316816078*^9, 
   3.62972695993924*^9, 3.6301580756997137`*^9, 3.631621160362499*^9, 
   3.631895952733695*^9, 3.632595168487883*^9, 3.632658801178734*^9, 
   3.635847745272004*^9, 3.6358724491079397`*^9, 3.636812738837298*^9, {
   3.636812799836112*^9, 3.6368128250742617`*^9}, 3.636813339449793*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eqn2p8", " ", "=", " ", 
  RowBox[{
   RowBox[{"eps", " ", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], ",", "t"}], 
     "]"}]}], " ", "+", " ", 
   RowBox[{
    RowBox[{"eps", "^", "2"}], " ", 
    RowBox[{"DG2", "[", 
     RowBox[{"Uvec2", ",", 
      RowBox[{"w", "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "]"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"eps", "^", "2"}], "/", 
      RowBox[{"mu", "^", "2"}]}], ")"}], " ", 
    RowBox[{"w", "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"w", "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], ",", "z"}], 
     "]"}]}], "+", 
   RowBox[{"eps", " ", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "/", "rho"}], ",",
       "z"}], "]"}]}], "+", "1"}]}]], "Input",
 CellChangeTimes->{{3.608026228708207*^9, 3.608026355037621*^9}, {
  3.608026394151857*^9, 3.60802639824482*^9}, {3.608026512266871*^9, 
  3.608026512631853*^9}, {3.6084644153687963`*^9, 3.60846442028611*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{"eps", " ", 
   RowBox[{
    SuperscriptBox["w", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "+", 
  FractionBox[
   RowBox[{"eps", " ", 
    RowBox[{
     SuperscriptBox["p", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "rho"], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["eps", "2"], " ", 
    RowBox[{"w", "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
    RowBox[{
     SuperscriptBox["w", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], 
   SuperscriptBox["mu", "2"]], "+", 
  RowBox[{
   SuperscriptBox["eps", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["w", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["w", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.608299462621064*^9, 3.608463414965661*^9, 3.608464490618346*^9, 
   3.608471274075014*^9, 3.608479851544331*^9, 3.608571025715637*^9, 
   3.608574619502922*^9, 3.608575742886903*^9, 3.60862938377212*^9, 
   3.608634669220566*^9, 3.608651079811125*^9, 3.609174555054154*^9, 
   3.609175339245492*^9, 3.609175429583589*^9, 3.609176663969783*^9, 
   3.609234576011056*^9, 3.609254831268311*^9, 3.60925552710678*^9, 
   3.609838782358452*^9, 3.609839107835445*^9, 3.610265581882702*^9, 
   3.6108836576323557`*^9, 3.612033251304751*^9, 3.6120333507050953`*^9, 
   3.612263789502761*^9, 3.6122643660437813`*^9, 3.612717134450951*^9, 
   3.626621166062718*^9, 3.6266236239875193`*^9, 3.626625244407794*^9, 
   3.626634092157254*^9, 3.626634175742756*^9, 3.6267105053532677`*^9, 
   3.626721109171289*^9, 3.6267709620303917`*^9, 3.626771359653595*^9, 
   3.626797330882988*^9, 3.626798326488113*^9, 3.626799253480475*^9, 
   3.6273836146278963`*^9, 3.627738047654338*^9, 3.627989167954021*^9, 
   3.627991316848813*^9, 3.62972695998114*^9, 3.630158075739872*^9, 
   3.631621160418839*^9, 3.631895952790428*^9, 3.632595168536727*^9, 
   3.632658801255691*^9, 3.635847745304002*^9, 3.635872449160344*^9, 
   3.636812738897369*^9, {3.636812804530972*^9, 3.636812827823492*^9}, 
   3.6368133394870462`*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"Eqn2p8", "-", "Mom3Final"}], "]"}]], "Input",
 CellChangeTimes->{{3.6080263728350697`*^9, 3.608026380208281*^9}},
 FontSize->14],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6080263807475653`*^9, 3.6080264027789373`*^9}, 
   3.608026448523328*^9, 3.6080264841788673`*^9, 3.608026517387271*^9, {
   3.6080266279649553`*^9, 3.608026699899135*^9}, 3.608299462626576*^9, 
   3.608463415056415*^9, 3.608464490651931*^9, 3.608471274115703*^9, 
   3.608479851648447*^9, 3.608571025846072*^9, 3.608574619548683*^9, 
   3.6085757429099903`*^9, 3.608629383880021*^9, 3.6086346692519207`*^9, 
   3.608651079929946*^9, 3.609174555175263*^9, 3.6091753393513813`*^9, 
   3.609175429690772*^9, 3.609176664022337*^9, 3.6092345760408583`*^9, 
   3.609254831355335*^9, 3.609255527258854*^9, 3.6098387824647617`*^9, 
   3.609839117842593*^9, 3.6102655818980494`*^9, 3.610883657653618*^9, 
   3.612033251309222*^9, 3.612033350709745*^9, 3.612263789507106*^9, 
   3.612264366048506*^9, 3.6127171344553556`*^9, 3.6266211660668507`*^9, 
   3.626623623991955*^9, 3.626625244411593*^9, 3.626634092161106*^9, 
   3.626634175806774*^9, 3.6267105053575697`*^9, 3.626721109174947*^9, 
   3.626770962033999*^9, 3.626771359659275*^9, 3.6267973308888083`*^9, 
   3.62679832649934*^9, 3.6267992534842663`*^9, 3.627383614632825*^9, 
   3.627738047659128*^9, 3.627989167958274*^9, 3.627991316881193*^9, 
   3.629726960009046*^9, 3.630158075743922*^9, 3.631621160423853*^9, 
   3.6318959527940893`*^9, 3.63259516854178*^9, 3.6326588013445253`*^9, 
   3.635847745309004*^9, 3.635872449164328*^9, 3.636812738954801*^9, {
   3.636812807617557*^9, 3.6368128307297487`*^9}, 3.636813339491338*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Conservation", " ", "of", " ", 
      RowBox[{"zeta", ":", " ", 
       RowBox[{
        RowBox[{"D_t", " ", "zeta"}], " ", "+", " ", 
        RowBox[{"Grad", "[", 
         RowBox[{"u", " ", "zeta"}], "]"}]}]}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{"w", ".", " ", "Equation"}], " ", "2.12"}]}], ",", " ", 
    RowBox[{
    "show", " ", "that", " ", "we", " ", "get", " ", "the", " ", 
     "appropriate", " ", "value", " ", "of", " ", 
     RowBox[{"mu", "^", "2"}], " ", "out", " ", 
     RowBox[{"front", "."}]}]}], "*)"}], 
  RowBox[{"Simplify", "[", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"zeta", "[", 
            RowBox[{"x", ",", "y", ",", "t"}], "]"}], ",", "t"}], "]"}], "+", 
         " ", 
         RowBox[{"DG2", "[", 
          RowBox[{"Uvec2", ",", 
           RowBox[{"zeta", "[", 
            RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "]"}]}], ")"}], "/", 
       RowBox[{"w", "[", 
        RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], " ", "/.", " ", 
      "ConvertToDimensionlessRules"}], " ", "/.", " ", 
     "NormalizeCoordinates"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"l0", ">", "0"}], ",", 
      RowBox[{"mu", ">", "0"}], ",", 
      RowBox[{"g", ">", "0"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.608026850724128*^9, 3.608026940367818*^9}, {
  3.608027020399886*^9, 3.608027025913724*^9}, {3.608027100712164*^9, 
  3.608027108655315*^9}, {3.608027141260079*^9, 3.608027224711961*^9}, {
  3.608027263783628*^9, 3.608027286290112*^9}, {3.608027516181213*^9, 
  3.6080275230173187`*^9}, {3.608027615273526*^9, 3.60802763254041*^9}, {
  3.608027683047469*^9, 3.608027685857717*^9}, {3.6080285478509827`*^9, 
  3.608028548560981*^9}, {3.608464430365987*^9, 3.6084644355731173`*^9}, {
  3.6098391543988237`*^9, 3.609839174546276*^9}, {3.6266210453872766`*^9, 
  3.626621074010264*^9}},
 FontSize->14],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["mu", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["zeta", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "t"}], "]"}], "+", 
     RowBox[{"eps", " ", 
      RowBox[{"v", "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["zeta", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
     RowBox[{"eps", " ", 
      RowBox[{"u", "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["zeta", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}]}], 
  RowBox[{"w", "[", 
   RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]]], "Output",
 CellChangeTimes->{{3.6080271614126787`*^9, 3.608027225060957*^9}, 
   3.60802726826855*^9, 3.608027342757251*^9, {3.608027481109477*^9, 
   3.608027500973598*^9}, 3.6080276895177603`*^9, 3.608028540654735*^9, 
   3.608299462671803*^9, 3.608463415106956*^9, 3.608464490684719*^9, 
   3.608471274154374*^9, 3.608479851687422*^9, 3.608571025872732*^9, 
   3.608574619575446*^9, 3.608575742935306*^9, 3.608629383918951*^9, 
   3.6086346692864637`*^9, 3.608651079972187*^9, 3.6091745552172527`*^9, 
   3.60917533938134*^9, 3.609175429720749*^9, 3.609176664054653*^9, 
   3.609234576092712*^9, 3.6092548314460917`*^9, 3.609255527293832*^9, 
   3.609838782503552*^9, 3.609839134371496*^9, 3.609839190465638*^9, 
   3.610265581915416*^9, 3.610883657689786*^9, 3.6120332513467913`*^9, 
   3.612033350745996*^9, 3.6122637895484257`*^9, 3.612264366093317*^9, 
   3.612717134495256*^9, 3.6266211661068068`*^9, 3.626623624028266*^9, 
   3.6266252444493847`*^9, 3.626634113726359*^9, 3.626634175833437*^9, 
   3.626710505391626*^9, 3.6267211092145977`*^9, 3.62677096208594*^9, 
   3.626771359701434*^9, 3.626797330930503*^9, 3.626798326553397*^9, 
   3.626799253523432*^9, 3.627383614672379*^9, 3.627738047706321*^9, 
   3.627989168000877*^9, 3.627991316914854*^9, 3.6297269600449142`*^9, 
   3.630158075789604*^9, 3.631621160483918*^9, 3.6318959528568707`*^9, 
   3.632595168602029*^9, 3.632658801418003*^9, 3.635847745349827*^9, 
   3.635872449221903*^9, 3.636812739018607*^9, 3.6368128341717987`*^9, 
   3.636813339536792*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "To", " ", "derive", " ", "Hsaio", " ", "Eqn", " ", "2.14", " ", "we", 
      " ", "create", " ", "the", " ", "ZeroAtBottom", " ", 
      RowBox[{"function", ".", " ", 
       RowBox[{"It", "'"}]}], "s", " ", "gradient", " ", "will", " ", "be", 
      " ", "normal", " ", "to", " ", "the", " ", "surface", " ", "where", " ",
       "the", " ", "function", " ", "is", " ", 
      RowBox[{"constant", ".", " ", "Because"}], " ", 
      RowBox[{"it", "'"}], "s", " ", "constant", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"it", "'"}], "z", " ", "zero"}], ")"}], " ", "at", " ", "z"}],
      " ", "=", " ", 
     RowBox[{"-", "h"}]}], ",", " ", 
    RowBox[{
    "we", " ", "can", " ", "use", " ", "it", " ", "to", " ", "compute", " ", 
     "the", " ", "flux", " ", "through", " ", "the", " ", 
     RowBox[{"bottom", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ZeroAtBottom", "[", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], " ", ":=", " ", 
     RowBox[{"z", " ", "+", 
      RowBox[{"h", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DivZero", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Grad", "[", 
           RowBox[{
            RowBox[{"ZeroAtBottom", "[", 
             RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "Coords"}], "]"}],
           " ", ".", " ", "Uvec"}], ")"}], "/.", " ", 
        "ConvertToDimensionlessRules"}], " ", "/.", " ", 
       "NormalizeCoordinates"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"0", "\[Equal]", "DivZero"}], ",", 
     RowBox[{"{", 
      RowBox[{"w", "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6080279478547497`*^9, 3.608028018995183*^9}, {
   3.608028204994685*^9, 3.6080283882106657`*^9}, {3.608028454070529*^9, 
   3.608028454830669*^9}, {3.6080291197154617`*^9, 3.60802912150988*^9}, {
   3.609839204607974*^9, 3.609839207503768*^9}, {3.609839241701274*^9, 
   3.609839254301442*^9}, {3.609839306843524*^9, 3.60983937233825*^9}, {
   3.6098394332219763`*^9, 3.60983947266891*^9}, 3.609839575929881*^9, {
   3.6098397375836067`*^9, 3.60983975112819*^9}, {3.62662109417288*^9, 
   3.6266211292230663`*^9}, 3.626621161683106*^9},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"w", "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["mu", "2"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.608028288653908*^9, 3.608028316981986*^9}, 
   3.608028388798184*^9, 3.608299462709648*^9, 3.608463415163712*^9, 
   3.6084644907178926`*^9, 3.608471274194962*^9, 3.6084798517200613`*^9, 
   3.608571025903561*^9, 3.6085746196207047`*^9, 3.6085757429590597`*^9, 
   3.608629383971396*^9, 3.608634669354466*^9, 3.608651080039411*^9, 
   3.609174555261869*^9, 3.6091753394129143`*^9, 3.609175429764565*^9, 
   3.609176664084593*^9, 3.609234576114799*^9, 3.6092548315582333`*^9, 
   3.609255527334463*^9, 3.609838782539084*^9, {3.609839242908618*^9, 
   3.6098392546215763`*^9}, 3.609839310835828*^9, {3.6098393446097307`*^9, 
   3.609839372875476*^9}, 3.609839434404058*^9, 3.609839473196517*^9, 
   3.609839518965494*^9, 3.609839576396008*^9, 3.609839608484466*^9, {
   3.609839739988776*^9, 3.609839754301146*^9}, 3.610265581940806*^9, 
   3.610883657731814*^9, 3.6120332513838577`*^9, 3.612033350773593*^9, 
   3.612263789579527*^9, 3.612264366127778*^9, 3.612717134526514*^9, {
   3.626621100444257*^9, 3.62662113039459*^9}, {3.6266211625463963`*^9, 
   3.626621166139402*^9}, 3.626623624068603*^9, 3.626625244483246*^9, 
   3.626634113816023*^9, 3.626634175864699*^9, 3.6267105054221563`*^9, 
   3.626721109249938*^9, 3.626770962130898*^9, 3.6267713597379827`*^9, 
   3.626797330964098*^9, 3.626798326591793*^9, 3.626799253555686*^9, 
   3.627383614710928*^9, 3.627738047742412*^9, 3.6279891680420094`*^9, 
   3.6279913169492807`*^9, 3.629726960080249*^9, 3.630158075827272*^9, 
   3.631621160535075*^9, 3.631895952912513*^9, 3.6325951686518*^9, 
   3.6326588015229673`*^9, 3.635847745386161*^9, 3.635872449275738*^9, 
   3.636812739085644*^9, 3.6368128377124557`*^9, 3.63681333957568*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Hsaiao", " ", 
    RowBox[{"Eqn", ".", " ", "3.5"}], " ", "comes", " ", "from", " ", 
    "requiring", " ", "the", " ", "curl", " ", "to", " ", "vanish"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"OrderExpansion", "=", 
    RowBox[{"Expand", "[", 
     RowBox[{
      RowBox[{"Curl", "[", 
       RowBox[{"Uvec", ",", "Coords"}], "]"}], "/.", " ", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"u", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"u0", "[", 
             RowBox[{"#1", ",", "#2", ",", "#4"}], "]"}], "+", 
            RowBox[{
             RowBox[{"mu", "^", "2"}], " ", 
             RowBox[{"u1", "[", 
              RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}]}], " ",
            "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"v", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"v0", "[", 
             RowBox[{"#1", ",", "#2", ",", "#4"}], "]"}], "+", 
            RowBox[{
             RowBox[{"mu", "^", "2"}], " ", 
             RowBox[{"v1", "[", 
              RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}]}], " ",
            "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"w", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"mu", "^", "2"}], " ", 
            RowBox[{"w1f", "[", 
             RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}], "&"}], 
          ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"p", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "g"}], " ", "z"}], "+", 
            RowBox[{
             RowBox[{"mu", "^", "2"}], " ", 
             RowBox[{"p1", "[", 
              RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}]}], " ",
            "&"}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"ZeroOrder", " ", "=", " ", 
    RowBox[{"(", 
     RowBox[{"OrderExpansion", " ", "/.", " ", 
      RowBox[{"mu", "\[Rule]", "0"}]}], ")"}]}], " ", "\[IndentingNewLine]", 
   RowBox[{"Order2", " ", "=", " ", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"OrderExpansion", ",", 
      RowBox[{"mu", "^", "2"}]}], "]"}], " "}]}]}]], "Input",
 CellChangeTimes->{{3.609842767130363*^9, 3.6098427933284492`*^9}, {
  3.609842832405232*^9, 3.6098428737560062`*^9}, {3.609842915480406*^9, 
  3.609842936521674*^9}, {3.609842999856928*^9, 3.609843004410078*^9}, {
  3.609843051568571*^9, 3.609843064548409*^9}, {3.609843197792856*^9, 
  3.609843261746148*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["mu", "2"]}], " ", 
     RowBox[{
      SuperscriptBox["v1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["mu", "2"], " ", 
     RowBox[{
      SuperscriptBox["w1f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["mu", "2"], " ", 
     RowBox[{
      SuperscriptBox["u1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["mu", "2"], " ", 
     RowBox[{
      SuperscriptBox["w1f", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      SuperscriptBox["u0", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["v0", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y", ",", "t"}], "]"}], "-", 
    RowBox[{
     SuperscriptBox["mu", "2"], " ", 
     RowBox[{
      SuperscriptBox["u1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["mu", "2"], " ", 
     RowBox[{
      SuperscriptBox["v1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.609842772738205*^9, 3.60984279405451*^9}, {
   3.609842850765685*^9, 3.609842874481439*^9}, {3.609842918497575*^9, 
   3.6098429369672956`*^9}, 3.609843005153626*^9, 3.609843065106474*^9, {
   3.609843203582347*^9, 3.609843262217844*^9}, 3.610265582159111*^9, 
   3.610883657971601*^9, 3.61203325160373*^9, 3.612033350975746*^9, 
   3.612263789778228*^9, 3.6122643661634073`*^9, 3.612717134715445*^9, 
   3.626621166162883*^9, 3.626623624249132*^9, 3.6266252445154*^9, 
   3.626634113828238*^9, 3.626634175880569*^9, 3.626710505593692*^9, 
   3.626721109284872*^9, 3.626770962181181*^9, 3.626771359776868*^9, 
   3.626797331145276*^9, 3.626798326622644*^9, 3.626799253656397*^9, 
   3.627383614735977*^9, 3.62773804795407*^9, 3.627989168257455*^9, 
   3.6279913171593933`*^9, 3.629726960186832*^9, 3.630158075864719*^9, 
   3.6316211607296143`*^9, 3.631895952967444*^9, 3.632595168841907*^9, 
   3.632658801565333*^9, 3.6358477455546722`*^9, 3.635872449330039*^9, 
   3.636812739150366*^9, 3.636813339615416*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      SuperscriptBox["u0", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["v0", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.609842772738205*^9, 3.60984279405451*^9}, {
   3.609842850765685*^9, 3.609842874481439*^9}, {3.609842918497575*^9, 
   3.6098429369672956`*^9}, 3.609843005153626*^9, 3.609843065106474*^9, {
   3.609843203582347*^9, 3.609843262217844*^9}, 3.610265582159111*^9, 
   3.610883657971601*^9, 3.61203325160373*^9, 3.612033350975746*^9, 
   3.612263789778228*^9, 3.6122643661634073`*^9, 3.612717134715445*^9, 
   3.626621166162883*^9, 3.626623624249132*^9, 3.6266252445154*^9, 
   3.626634113828238*^9, 3.626634175880569*^9, 3.626710505593692*^9, 
   3.626721109284872*^9, 3.626770962181181*^9, 3.626771359776868*^9, 
   3.626797331145276*^9, 3.626798326622644*^9, 3.626799253656397*^9, 
   3.627383614735977*^9, 3.62773804795407*^9, 3.627989168257455*^9, 
   3.6279913171593933`*^9, 3.629726960186832*^9, 3.630158075864719*^9, 
   3.6316211607296143`*^9, 3.631895952967444*^9, 3.632595168841907*^9, 
   3.632658801565333*^9, 3.6358477455546722`*^9, 3.635872449330039*^9, 
   3.636812739150366*^9, 3.636813339617044*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      SuperscriptBox["v1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["w1f", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["u1", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "-", 
    RowBox[{
     SuperscriptBox["w1f", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{
      SuperscriptBox["u1", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "+", 
    RowBox[{
     SuperscriptBox["v1", 
      TagBox[
       RowBox[{"(", 
        RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
       Derivative],
      MultilineFunction->None], "[", 
     RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.609842772738205*^9, 3.60984279405451*^9}, {
   3.609842850765685*^9, 3.609842874481439*^9}, {3.609842918497575*^9, 
   3.6098429369672956`*^9}, 3.609843005153626*^9, 3.609843065106474*^9, {
   3.609843203582347*^9, 3.609843262217844*^9}, 3.610265582159111*^9, 
   3.610883657971601*^9, 3.61203325160373*^9, 3.612033350975746*^9, 
   3.612263789778228*^9, 3.6122643661634073`*^9, 3.612717134715445*^9, 
   3.626621166162883*^9, 3.626623624249132*^9, 3.6266252445154*^9, 
   3.626634113828238*^9, 3.626634175880569*^9, 3.626710505593692*^9, 
   3.626721109284872*^9, 3.626770962181181*^9, 3.626771359776868*^9, 
   3.626797331145276*^9, 3.626798326622644*^9, 3.626799253656397*^9, 
   3.627383614735977*^9, 3.62773804795407*^9, 3.627989168257455*^9, 
   3.6279913171593933`*^9, 3.629726960186832*^9, 3.630158075864719*^9, 
   3.6316211607296143`*^9, 3.631895952967444*^9, 3.632595168841907*^9, 
   3.632658801565333*^9, 3.6358477455546722`*^9, 3.635872449330039*^9, 
   3.636812739150366*^9, 3.636813339618342*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Basis", " ", "for", " ", "Hsaiao", " ", "3.7"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Simplify", "[", 
   RowBox[{"(", 
    RowBox[{"MassEqn", " ", 
     RowBox[{
      RowBox[{"l0", "/", "eps"}], " ", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"g", " ", "l0", " ", "mu"}], "]"}]}]}], ")"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.612034361466383*^9, 3.612034364330399*^9}, {
  3.612263988002358*^9, 3.6122639964795113`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["w", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], 
   SuperscriptBox["mu", "2"]], "+", 
  RowBox[{
   SuperscriptBox["v", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "+", 
  RowBox[{
   SuperscriptBox["u", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.612034357123384*^9, 3.612034364670412*^9}, 
   3.61226378984304*^9, 3.6122639971763687`*^9, 3.612264366201276*^9, 
   3.612717134749296*^9, 3.6266211662047253`*^9, 3.626623624298608*^9, 
   3.6266252445466022`*^9, 3.626634113847774*^9, 3.626634175902402*^9, 
   3.626710505627903*^9, 3.626721109325783*^9, 3.626770962240611*^9, 
   3.6267713598230247`*^9, 3.626797331185052*^9, 3.626798326658351*^9, 
   3.6267992538317623`*^9, 3.627383614757976*^9, 3.627738048047545*^9, 
   3.627989168377864*^9, 3.627991317205645*^9, 3.629726960223988*^9, 
   3.630158075902873*^9, 3.63162116088125*^9, 3.631895953025364*^9, 
   3.632595168891728*^9, 3.63265880160472*^9, 3.635847745622592*^9, 
   3.6358724493712273`*^9, 3.6368127392180853`*^9, 3.636813339660893*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Hsaiao", " ", "3.7", " ", "comes", " ", "from", " ", "the", " ", 
    RowBox[{"MassEqn", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OrderExpansion", "=", 
     RowBox[{"Expand", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"MassEqn", " ", 
         RowBox[{
          RowBox[{"l0", "/", "eps"}], " ", "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"g", " ", "l0", " ", "mu"}], "]"}]}]}], ")"}], "/.", " ", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"u", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"u0", "[", 
              RowBox[{"#1", ",", "#2", ",", "#4"}], "]"}], "+", 
             RowBox[{
              RowBox[{"mu", "^", "2"}], " ", 
              RowBox[{"u1", "[", 
               RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}]}], 
            " ", "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"v", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"v0", "[", 
              RowBox[{"#1", ",", "#2", ",", "#4"}], "]"}], "+", 
             RowBox[{
              RowBox[{"mu", "^", "2"}], " ", 
              RowBox[{"v1", "[", 
               RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}]}], 
            " ", "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"w", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"mu", "^", "2"}], " ", 
             RowBox[{"w1f", "[", 
              RowBox[{"#1", ",", "#2", ",", "#3", ",", " ", "#4"}], "]"}]}], 
            "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"p", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "g"}], " ", "z"}], "+", 
             RowBox[{
              RowBox[{"mu", "^", "2"}], " ", 
              RowBox[{"p1", "[", 
               RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}]}], 
            " ", "&"}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"ZeroOrder", " ", "=", " ", 
    RowBox[{"(", 
     RowBox[{"OrderExpansion", " ", "/.", " ", 
      RowBox[{"mu", "\[Rule]", "0"}]}], ")"}], " "}]}]}]], "Input",
 CellChangeTimes->{{3.609840479714868*^9, 3.609840679413444*^9}, {
   3.609840726593951*^9, 3.609840794200753*^9}, {3.609840843534346*^9, 
   3.609840902955154*^9}, {3.6098409922396917`*^9, 3.6098410351962852`*^9}, {
   3.609841080563931*^9, 3.609841229403524*^9}, {3.60984128046023*^9, 
   3.609841458114648*^9}, {3.6098414897665863`*^9, 3.609841723365769*^9}, {
   3.6098431151996737`*^9, 3.6098431245296583`*^9}, 3.6120342065329723`*^9, {
   3.6120343040869093`*^9, 3.612034305281842*^9}, 3.612034406267654*^9, {
   3.612034437828951*^9, 3.6120344647998753`*^9}, {3.612263890674447*^9, 
   3.612263891176618*^9}, {3.61226392546931*^9, 3.612263978497756*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["v0", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "1", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x", ",", "y", ",", "t"}], "]"}], "+", 
  RowBox[{
   SuperscriptBox["u0", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"1", ",", "0", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x", ",", "y", ",", "t"}], "]"}], "+", 
  RowBox[{
   SuperscriptBox["w1f", 
    TagBox[
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
     Derivative],
    MultilineFunction->None], "[", 
   RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.612263914044127*^9, 3.612263927515945*^9}, {
   3.6122639585308857`*^9, 3.6122639789477882`*^9}, 3.6122643662385273`*^9, 
   3.612717134777763*^9, 3.626621166243483*^9, 3.626623624331069*^9, 
   3.626625244574568*^9, 3.626634113863665*^9, 3.626634175915043*^9, 
   3.6267105056573877`*^9, 3.626721109361435*^9, 3.626770962287963*^9, 
   3.6267713598676567`*^9, 3.6267973312144527`*^9, 3.626798326698028*^9, 
   3.626799253865489*^9, 3.627383614776595*^9, 3.62773804808097*^9, 
   3.627989168414444*^9, 3.6279913172404346`*^9, 3.6297269602534437`*^9, 
   3.630158075937728*^9, 3.6316211609547863`*^9, 3.6318959530792627`*^9, 
   3.632595169012351*^9, 3.632658801637006*^9, 3.635847745650465*^9, 
   3.635872449409089*^9, 3.636812739281011*^9, 3.636813339703658*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Now", " ", "compute", " ", "3.13", " ", "and", " ", "3.14", " ", "by", 
    " ", "integrating", " ", "3.5"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{"U0vec2", ",", "w1", ",", "U1vec2"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"U0vec2", " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u0", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}], ",", 
       RowBox[{"v0", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "This", " ", "is", " ", "more", " ", "verbose", " ", "than", " ", "it", 
      " ", "should", " ", "be"}], ",", " ", 
     RowBox[{
     "but", " ", "it", " ", "needs", " ", "to", " ", "be", " ", "written", 
      " ", "this", " ", "way", " ", "or", " ", "subtle", " ", "problems", 
      "\[IndentingNewLine]", "occur", " ", "in", " ", "trying", " ", "to", 
      " ", "compute", " ", "the", " ", 
      RowBox[{"pressure", ".", " ", "I"}], " ", "need", " ", "to", " ", 
      "understand", " ", "this", " ", 
      RowBox[{"better", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w1", "[", 
     RowBox[{"x_", ",", "y_", ",", "z_", ",", "t_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "z"}], " ", 
      RowBox[{"Div", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u0", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], ",", 
          RowBox[{"v0", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], "-", " ", 
     RowBox[{"Div", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"h", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u0", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], ",", 
          RowBox[{"v0", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"U1vec2", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"G2", "[", 
        RowBox[{"w1", "[", 
         RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "]"}], ",", 
       "z"}], "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.608029183778718*^9, 3.6080292133201723`*^9}, {
   3.608029386298181*^9, 3.6080294821632347`*^9}, {3.6080295220431767`*^9, 
   3.6080295227356157`*^9}, {3.608029553805461*^9, 3.608029651188279*^9}, {
   3.608029699491076*^9, 3.608029746487741*^9}, {3.60802978394916*^9, 
   3.608029845009968*^9}, 3.608029974686277*^9, {3.608030082483663*^9, 
   3.608030140440187*^9}, {3.608030208349821*^9, 3.608030209837109*^9}, 
   3.6080318648406343`*^9, 3.612033320854607*^9, {3.6266215244606113`*^9, 
   3.626621525672295*^9}, {3.626621626945672*^9, 3.6266216299755373`*^9}, {
   3.626624117639135*^9, 3.6266241244694443`*^9}, {3.6266242056813*^9, 
   3.626624218805039*^9}, {3.6266249007905273`*^9, 3.62662495572357*^9}, {
   3.626624988794726*^9, 3.626625019045494*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", "z", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"v0", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"u0", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["v0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["u0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["v0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"z", " ", 
       RowBox[{
        SuperscriptBox["v0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"h", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["v0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"z", " ", 
       RowBox[{
        SuperscriptBox["u0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"h", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["u0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", "z", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"v0", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"u0", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["u0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["v0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"z", " ", 
       RowBox[{
        SuperscriptBox["v0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"h", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["v0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["u0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"z", " ", 
       RowBox[{
        SuperscriptBox["u0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"h", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["u0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6080294827146482`*^9, 3.6080295231328163`*^9, {3.608029557914167*^9, 
   3.608029577162216*^9}, {3.608029633085334*^9, 3.608029652119471*^9}, 
   3.608029747902111*^9, {3.608029787416471*^9, 3.608029845720862*^9}, 
   3.6080299754271603`*^9, 3.608030141168734*^9, 3.608030210482654*^9, 
   3.6080318655003223`*^9, 3.6082994627989893`*^9, 3.608463415269623*^9, 
   3.608464490789538*^9, 3.608471274271501*^9, 3.608479851796661*^9, 
   3.6085710259809732`*^9, 3.608574619697563*^9, 3.608575743026944*^9, 
   3.6086293840505*^9, 3.608634669430295*^9, 3.6086510801213903`*^9, 
   3.609174555345901*^9, 3.609175339482909*^9, 3.6091754298370237`*^9, 
   3.6091766641625223`*^9, 3.609234576178306*^9, 3.6092548318195963`*^9, 
   3.6092555274197893`*^9, 3.609838782618438*^9, 3.610265582430812*^9, 
   3.610883658244124*^9, 3.6120332516945887`*^9, 3.612033351061447*^9, 
   3.6122637899300127`*^9, 3.612264366288018*^9, 3.612717134828394*^9, 
   3.6266211662940063`*^9, 3.626621526293042*^9, 3.626623624384014*^9, 
   3.626624125131584*^9, {3.626624209921225*^9, 3.626624219466441*^9}, {
   3.626624929412858*^9, 3.6266249563987427`*^9}, 3.626625244618039*^9, 
   3.626634113925172*^9, 3.626634175971764*^9, 3.6267105057095118`*^9, 
   3.626721109412793*^9, 3.626770962343446*^9, 3.62677135991998*^9, 
   3.626797331292965*^9, 3.626798326755909*^9, 3.626799253920343*^9, 
   3.627383614829664*^9, 3.6277380481408787`*^9, 3.6279891684801807`*^9, 
   3.6279913172945347`*^9, 3.629726960379046*^9, 3.630158075991826*^9, 
   3.631621161014731*^9, 3.631895953138041*^9, 3.632595169072117*^9, 
   3.632658801691348*^9, 3.635847745712035*^9, 3.63587244945925*^9, 
   3.636812739447791*^9, 3.636813339753427*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Now", " ", "subtract", " ", "off", " ", 
    RowBox[{"what", "'"}], "s", " ", "written", " ", "in", " ", "3.13", " ", 
    "and", " ", "3.14", " ", "to", " ", "check", " ", "our", " ", "answer"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Expand", "[", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", " ", 
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}]}], 
       RowBox[{"z", "^", "2"}], " ", 
       RowBox[{"G2", "[", 
        RowBox[{"D2", "[", "U0vec2", "]"}], "]"}]}], "-", 
      RowBox[{"z", " ", 
       RowBox[{"G2", "[", 
        RowBox[{"D2", "[", 
         RowBox[{
          RowBox[{"h", "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", "U0vec2"}], "]"}], "]"}]}]}], 
     ")"}], "-", "U1vec2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6080298567381163`*^9, 3.608030052422062*^9}, {
   3.6080301496995363`*^9, 3.608030261998044*^9}, {3.6080305287586937`*^9, 
   3.608030558613928*^9}, {3.608030691029085*^9, 3.608030734715053*^9}, 
   3.608031872597967*^9},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.608029942704585*^9, {3.608030031873146*^9, 3.608030052880559*^9}, {
   3.608030173152863*^9, 3.608030262568639*^9}, {3.608030530724731*^9, 
   3.6080305596325502`*^9}, {3.60803070274893*^9, 3.608030735376082*^9}, 
   3.608031873633692*^9, 3.60829946283245*^9, 3.6084634153213863`*^9, 
   3.60846449081957*^9, 3.6084712743065243`*^9, 3.608479851825098*^9, 
   3.6085710260097027`*^9, 3.6085746197206783`*^9, 3.608575743047819*^9, 
   3.6086293840792847`*^9, 3.6086346694567957`*^9, 3.608651080156535*^9, 
   3.60917455537834*^9, 3.6091753395079803`*^9, 3.609175429859907*^9, 
   3.6091766641909313`*^9, 3.609234576191839*^9, 3.6092548318999157`*^9, 
   3.60925552745553*^9, 3.6098387826487293`*^9, 3.610265582449675*^9, 
   3.6108836582672577`*^9, 3.6120332517623158`*^9, 3.612033351090351*^9, 
   3.612263789956931*^9, 3.612264366318163*^9, 3.6127171348959103`*^9, 
   3.626621166335153*^9, 3.626623624415854*^9, 3.626625244649041*^9, 
   3.626634113950651*^9, 3.626634175985503*^9, 3.626710505740163*^9, 
   3.626721109452753*^9, 3.6267709624381533`*^9, 3.626771359964514*^9, 
   3.626797331357712*^9, 3.626798326805028*^9, 3.626799253956414*^9, 
   3.627383614852717*^9, 3.6277380481753483`*^9, 3.627989168515036*^9, 
   3.627991317329381*^9, 3.629726960413313*^9, 3.630158076027679*^9, 
   3.63162116106371*^9, 3.631895953190559*^9, 3.632595169121644*^9, 
   3.632658801722926*^9, 3.635847745752818*^9, 3.63587244949824*^9, 
   3.636812739530684*^9, 3.6368133397964993`*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Hsaio", " ", "Eqn", " ", 
     RowBox[{"3.19", ".", " ", "Resolve"}], " ", "the", " ", "constants", " ",
      "of", " ", "integration", " ", "with", " ", "z_alpha", " ", "and", " ", 
     
     RowBox[{"u_alpha", ".", " ", "When"}], " ", "comparing", " ", "with", 
     " ", "Hsaio"}], ",", " ", 
    RowBox[{
     RowBox[{"use", " ", "n"}], "=", "0"}], ",", " ", 
    RowBox[{
    "as", " ", "we", " ", "are", " ", "really", " ", "trying", " ", "to", " ",
      "derive", " ", "the", " ", "basic", " ", 
     RowBox[{"equations", "."}]}]}], 
   StyleBox[" ",
    FontSlant->"Italic"], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Uavec2", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ua", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}], ",", 
       RowBox[{"va", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Uvec2v2", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"G2", "[", 
         RowBox[{"w1", "[", 
          RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "]"}], ",", 
        "z"}], "]"}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Eqn", " ", "3.13"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Uvec2v2a", " ", "=", " ", 
     RowBox[{"Uvec2v2", " ", "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"u0", "\[Rule]", "ua"}], ",", 
        RowBox[{"v0", "\[Rule]", "va"}]}], "}"}]}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "u0", " ", "and", " ", "ua", " ", "are", " ", "the", " ", "same", " ", 
     "to", " ", "zeroth", " ", "order", " ", "in", " ", 
     RowBox[{"mu", "^", "2"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Uvec2v2za", "=", " ", 
     RowBox[{"Uvec2v2a", "/.", " ", 
      RowBox[{"z", "\[Rule]", 
       RowBox[{"za", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Uvec2v3", " ", "=", " ", 
    RowBox[{"Uavec2", "+", 
     RowBox[{
      RowBox[{"mu", "^", "2"}], 
      RowBox[{"Simplify", "[", 
       RowBox[{"Uvec2v2a", "-", "Uvec2v2za"}], "]"}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{"Eqn", " ", "3.19"}], " ", "*)"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.608031828972665*^9, 3.608031844719005*^9}, {
   3.608031881044737*^9, 3.608032016623082*^9}, {3.608032277026793*^9, 
   3.608032290518896*^9}, {3.608032336345333*^9, 3.608032357998098*^9}, {
   3.608032389962777*^9, 3.608032391231215*^9}, {3.608033032135689*^9, 
   3.608033094626111*^9}, {3.608041822665351*^9, 3.608041845825872*^9}, {
   3.608041891703805*^9, 3.608041950941889*^9}, {3.608042495681834*^9, 
   3.608042510547923*^9}, {3.608042600525737*^9, 3.608042605097423*^9}, {
   3.60804287318204*^9, 3.6080428979746847`*^9}, {3.6080429403717747`*^9, 
   3.608042994316971*^9}, {3.608043299026992*^9, 3.6080433438171577`*^9}, {
   3.6080440328057404`*^9, 3.608044042856656*^9}, 3.608471260974876*^9},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"ua", "[", 
     RowBox[{"x", ",", "y", ",", "t"}], "]"}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["mu", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"z", "-", 
       RowBox[{"za", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"va", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"ua", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"2", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["va", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{"4", " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["ua", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["va", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{"z", " ", 
        RowBox[{
         SuperscriptBox["va", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"h", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["va", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"za", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["va", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{"z", " ", 
        RowBox[{
         SuperscriptBox["ua", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"2", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"h", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["ua", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"2", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"za", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["ua", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"2", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"va", "[", 
     RowBox[{"x", ",", "y", ",", "t"}], "]"}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     SuperscriptBox["mu", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"z", "-", 
       RowBox[{"za", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"va", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "2"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"ua", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["ua", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{"4", " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["va", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{"z", " ", 
        RowBox[{
         SuperscriptBox["va", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "2", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"h", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["va", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "2", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"za", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["va", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "2", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["ua", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{"z", " ", 
        RowBox[{
         SuperscriptBox["ua", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"h", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["ua", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"za", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["ua", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGAwBOJVst535zx65bhuWzXvQiAdZeY06SyQNjOuCD4PpHvW
ProPorcdYBZ8BaTvHl6/9A2QrvFgW/kFSLuX5jp/efzKccbSwqUgWuXdng0g
+slJdu+vQPpDFPskwSevHP9d+F8qDaRbjr8/A6I9GK5Nt3j6yrGp//xfjmev
HP8Ye500e/7KUWRhpUzGy1eOoa1PNEC06f39a28AaVfP019B9KObdzm3vXrl
yMd+Rtaa9bVj0QO+QBsg/e3NVGlbIK3A4FDgCKT3XWSoANEZdyz2pgFp6evr
X2UD6c7p/k4tQJoriqEERHfNz1GaCKRTjG7PA9HHtuwXmgSkw0rupK9ne+2o
eoatIoYdaM5LQbHrQLrSZ53SDSBdksM3T537tWOeZJP8LyB9Zply6xG+1445
zVqbvPhfO+ouVZVZIPDakcPGQm8/kF5dZelxRey14wxnw4gHQLqHrbhitcRr
R5N/VYdBNABUlcmN
  "],
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Verify", " ", "Eqn", " ", "3.13"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Uvec2v2", "-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}]}], " ", 
       RowBox[{"z", "^", "2"}], " ", 
       RowBox[{"G2", "[", 
        RowBox[{"D2", "[", "U0vec2", "]"}], "]"}]}], "-", 
      RowBox[{"z", " ", 
       RowBox[{"G2", "[", 
        RowBox[{"D2", "[", 
         RowBox[{
          RowBox[{"h", "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", "U0vec2"}], "]"}], "]"}]}]}], 
     ")"}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6080426368224573`*^9, 3.608042719437436*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.608042708575666*^9, 3.6080427201519814`*^9}, 
   3.608043367192762*^9, 3.6082994629032373`*^9, 3.6084634154270153`*^9, 
   3.608464490883779*^9, 3.608471274435327*^9, 3.608479851897233*^9, 
   3.608571026130629*^9, 3.608574619806424*^9, 3.608575743129631*^9, 
   3.608629384181576*^9, 3.6086346695469437`*^9, 3.608651080270464*^9, 
   3.609174555488202*^9, 3.609175339600206*^9, 3.6091754299550943`*^9, 
   3.609176664298649*^9, 3.609234576270937*^9, 3.609254832160161*^9, 
   3.609255527570883*^9, 3.609838782752467*^9, 3.610265582504773*^9, 
   3.610883658340477*^9, 3.612033251831399*^9, 3.612033351169663*^9, 
   3.6122637900222387`*^9, 3.612264366382835*^9, 3.612717134962718*^9, 
   3.626621166420635*^9, 3.626623624495122*^9, 3.626625244714508*^9, 
   3.626634114013863*^9, 3.626634176045394*^9, 3.6267105058062487`*^9, 
   3.626721109542506*^9, 3.626770962540062*^9, 3.6267713600555763`*^9, 
   3.626797331422352*^9, 3.626798326883936*^9, 3.62679925406689*^9, 
   3.627383614910049*^9, 3.6277380482472277`*^9, 3.627989168594226*^9, 
   3.627991317493216*^9, 3.6297269604794817`*^9, 3.630158076104295*^9, 
   3.631621161164361*^9, 3.631895953397833*^9, 3.6325951692266006`*^9, 
   3.632658801788938*^9, 3.635847745827115*^9, 3.63587244957936*^9, 
   3.636812739653309*^9, 3.636813339886273*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Verify", " ", "Eqn", " ", "3.19"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Uvec2v3", " ", "-", " ", 
    RowBox[{"(", 
     RowBox[{"Uavec2", "-", 
      RowBox[{
       RowBox[{"mu", "^", "2"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"z", "^", "2"}], "-", 
            RowBox[{
             RowBox[{"za", "[", 
              RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}]}], ")"}], 
          " ", 
          RowBox[{"G2", "[", 
           RowBox[{"D2", "[", "Uavec2", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"z", "-", 
            RowBox[{"za", "[", 
             RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}], " ", 
          RowBox[{"G2", "[", 
           RowBox[{"D2", "[", 
            RowBox[{
             RowBox[{"h", "[", 
              RowBox[{"x", ",", "y"}], "]"}], " ", "Uavec2"}], "]"}], 
           "]"}]}]}], ")"}]}]}], ")"}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6080430157815332`*^9, 3.608043189475552*^9}, {
  3.6084712612126503`*^9, 3.6084712612199793`*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJwVylsow2EcxvEhsxFGkhwyFEsZRRIjP6cYGYYUbpRDFAprjklzoRyyCyIt
LpaW06zsikakZEMRS/2dj+8ryqEcIr/34ulTT9+QqqaiagcejxePi6xZO969
JBCjm3hmys+4z+wrAmb5C38CFURWDjFJuYKbQm2abvcZdNKQqbWh+T0dyn3W
W27OmT9GvhdBjRkm/RM6bxYa3tH1seb092sCf/YWPXNSZjEyUxSuuR/oc5hQ
63VDQDLrogpAS9verMyHqNPxhFsCxYsHv4I7AuLh3J34ewIHvZ2BdY8EqrPu
JEzrwMaCHfWW2j6YquVzoZkQ4C3tBSU5U5hfEBXK0Nf18YBk1LSd2gxoCXFQ
M9MMiWs1aL3eRBrQdidlmgbti3ZqZeYVNIaOovsyTscc8d/01rJ/hatd4lMQ
vwrUFS4UBvk+vicoJ1wOtaPiOJEuwo1CT5sm+Bs1fIX3b3lQcOySmuSeFPRW
SeC0iMJhaqLUgkpLkrKPfCnkrMaWXaDTRpV6zo+CYrF7k/kPpD/hxQ==
  "],
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"U3", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Uvec2v2", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"Uvec2v2", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.610883690695796*^9, 3.610883747378026*^9}, 
   3.6108842019484797`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", "z", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"v0", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"u0", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["v0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["u0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["v0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"z", " ", 
       RowBox[{
        SuperscriptBox["v0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"h", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["v0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"z", " ", 
       RowBox[{
        SuperscriptBox["u0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"h", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["u0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", "z", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"v0", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"u0", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["u0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["v0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"z", " ", 
       RowBox[{
        SuperscriptBox["v0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"h", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["v0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["h", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["u0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"z", " ", 
       RowBox[{
        SuperscriptBox["u0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"h", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["u0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}]}], ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.610884202698166*^9, 3.612033251890122*^9, 
  3.612033351263516*^9, 3.6122637900941687`*^9, 3.612264366441515*^9, 
  3.6127171350203*^9, 3.626621166497052*^9, 3.626623624549251*^9, 
  3.626625244770773*^9, 3.626634114037574*^9, 3.626634176075296*^9, 
  3.6267105058627462`*^9, 3.626721109624222*^9, 3.626770962645239*^9, 
  3.6267713601445913`*^9, 3.62679733147538*^9, 3.626798326944092*^9, 
  3.626799254129423*^9, 3.6273836149496193`*^9, 3.627738048320137*^9, 
  3.6279891686628036`*^9, 3.6279913175709257`*^9, 3.629726960535515*^9, 
  3.630158076175735*^9, 3.631621161276803*^9, 3.631895953508646*^9, 
  3.632595169326333*^9, 3.6326588018517838`*^9, 3.63584774588284*^9, 
  3.635872449654595*^9, 3.6368127397706747`*^9, 3.636813339970001*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Computing", " ", "3.21", " ", "by", " ", "depth"}], "-", 
    RowBox[{"averaging", " ", "u"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Uavg", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{"Uvec2v2", ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", 
           RowBox[{"-", 
            RowBox[{"h", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], ",", 
           RowBox[{"eps", " ", 
            RowBox[{"zeta", "[", 
             RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], "}"}]}], "]"}], 
       "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"eps", " ", 
          RowBox[{"zeta", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
         RowBox[{"h", "[", 
          RowBox[{"x", ",", "y"}], "]"}]}], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ZeroToA", "[", "xx_", "]"}], " ", ":=", " ", 
    RowBox[{"xx", "  ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u0", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ua", "[", 
           RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ")"}]}], ",", 
       RowBox[{"v0", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"va", "[", 
           RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], "&"}], ")"}]}]}], 
      "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"Uavga", " ", "=", " ", 
    RowBox[{"ZeroToA", "[", "Uavg", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.608032109476225*^9, 3.608032203953189*^9}, {
  3.608033101460238*^9, 3.608033101570204*^9}, {3.6080331749848843`*^9, 
  3.6080332101627274`*^9}, {3.608034094419944*^9, 3.608034095153673*^9}, {
  3.608034152043006*^9, 3.608034156473364*^9}, {3.60803436149816*^9, 
  3.608034393051338*^9}, {3.6080435390105124`*^9, 3.6080435487189817`*^9}, {
  3.6080481063801937`*^9, 3.608048123632256*^9}, {3.608574284301642*^9, 
  3.6085743075956306`*^9}, {3.6122642072203007`*^9, 3.612264213138752*^9}, {
  3.6266217770868196`*^9, 3.626621795404975*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "6"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"h", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["va", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}], "+", 
         RowBox[{
          SuperscriptBox["ua", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"2", ",", "0", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{"va", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"ua", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["va", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
         RowBox[{"6", " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["ua", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["va", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "-", 
         RowBox[{"2", " ", "eps", " ", 
          RowBox[{"zeta", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["va", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "-", 
         RowBox[{"2", " ", "eps", " ", 
          RowBox[{"zeta", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["ua", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}]}], "-", 
      RowBox[{"eps", " ", 
       RowBox[{"zeta", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{"va", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"ua", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["va", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
         RowBox[{"6", " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["ua", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["va", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
         RowBox[{"eps", " ", 
          RowBox[{"zeta", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["va", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
         RowBox[{"eps", " ", 
          RowBox[{"zeta", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["ua", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"2", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
   ",", 
   RowBox[{
    FractionBox["1", "6"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"h", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["va", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"0", ",", "2", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}], "+", 
         RowBox[{
          SuperscriptBox["ua", 
           TagBox[
            RowBox[{"(", 
             RowBox[{"1", ",", "1", ",", "0"}], ")"}],
            Derivative],
           MultilineFunction->None], "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{"va", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"ua", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["ua", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
         RowBox[{"6", " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["va", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "-", 
         RowBox[{"2", " ", "eps", " ", 
          RowBox[{"zeta", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["va", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["ua", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "-", 
         RowBox[{"2", " ", "eps", " ", 
          RowBox[{"zeta", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["ua", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}]}], "-", 
      RowBox[{"eps", " ", 
       RowBox[{"zeta", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          RowBox[{"va", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"ua", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["ua", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
         RowBox[{"6", " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["va", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
         RowBox[{"eps", " ", 
          RowBox[{"zeta", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["va", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
         RowBox[{"3", " ", 
          RowBox[{
           SuperscriptBox["h", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["ua", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
         RowBox[{"eps", " ", 
          RowBox[{"zeta", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["ua", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}]}]}], ")"}]}]}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.6080321327320633`*^9, {3.608032181240711*^9, 3.6080322052760983`*^9}, 
   3.608032394176087*^9, 3.608033105618071*^9, {3.608033170221118*^9, 
   3.608033188712658*^9}, 3.608033221363556*^9, 3.6080340988483953`*^9, 
   3.608034160561384*^9, {3.6080343688267107`*^9, 3.608034410823188*^9}, 
   3.6080419585432587`*^9, 3.608043549599112*^9, 3.608048124388855*^9, 
   3.608299463133647*^9, 3.608463415652997*^9, 3.60846449101502*^9, 
   3.6084712745925713`*^9, 3.60847985209492*^9, 3.6085710263595953`*^9, 
   3.6085743082235403`*^9, 3.608574619937772*^9, 3.60857574326059*^9, 
   3.6086293844053183`*^9, 3.608634669714415*^9, 3.608651080450333*^9, 
   3.6091745557153273`*^9, 3.609175339772778*^9, 3.6091754301284237`*^9, 
   3.609176664476664*^9, 3.609234576478504*^9, 3.6092548324145412`*^9, 
   3.609255527827633*^9, 3.6098387829934797`*^9, 3.6102655827093287`*^9, 
   3.6108836585948887`*^9, 3.612033252084927*^9, 3.612033351472239*^9, 
   3.612263790343154*^9, 3.6122642152598753`*^9, 3.612264366587678*^9, 
   3.612717135202189*^9, 3.626621166659432*^9, 3.626623624699419*^9, 
   3.62662524488472*^9, 3.626634114178658*^9, 3.6266341761967487`*^9, 
   3.6267105060299797`*^9, 3.626721109781739*^9, 3.6267709628623533`*^9, 
   3.626771360255829*^9, 3.626797331807989*^9, 3.6267983270621233`*^9, 
   3.626799254283855*^9, 3.627383615358927*^9, 3.627738048702106*^9, 
   3.627989169047365*^9, 3.627991317730888*^9, 3.629726960935873*^9, 
   3.6301580766155663`*^9, 3.631621161776332*^9, 3.631895953971043*^9, 
   3.632595169775443*^9, 3.632658802335134*^9, 3.6358477463596478`*^9, 
   3.635872450184039*^9, 3.636812740225953*^9, 3.6368133401680593`*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eqn3p21", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", " ", 
     RowBox[{"(", 
      RowBox[{"1", "/", "6"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"eps", "^", "2"}], " ", 
       RowBox[{
        RowBox[{"zeta", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}]}], "-", 
      RowBox[{"eps", " ", 
       RowBox[{"zeta", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
       RowBox[{"h", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "^", "2"}]}], ")"}], 
    RowBox[{"G2", "[", 
     RowBox[{"D2", "[", "U0vec2", "]"}], "]"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"eps", " ", 
       RowBox[{"zeta", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "-", 
      RowBox[{"h", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], ")"}], " ", 
    RowBox[{"G2", "[", 
     RowBox[{"D2", "[", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", "U0vec2"}], "]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.608032218889605*^9, 3.608032222773849*^9}, {
  3.608032320544787*^9, 3.6080323211312237`*^9}, {3.608032370598261*^9, 
  3.6080325318291073`*^9}, {3.608032577484774*^9, 3.608032577637533*^9}, {
  3.608032646860704*^9, 3.608032722646085*^9}, {3.6080331964644327`*^9, 
  3.6080332025276623`*^9}, {3.6080346349529953`*^9, 3.608034638576391*^9}, {
  3.6080348018261843`*^9, 3.608034835893577*^9}, {3.608034920545081*^9, 
  3.608034926790554*^9}, {3.608035021927218*^9, 3.608035024382468*^9}, {
  3.608035209263751*^9, 3.608035215717537*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "6"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"h", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
       RowBox[{"eps", " ", 
        RowBox[{"h", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"zeta", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["eps", "2"], " ", 
        SuperscriptBox[
         RowBox[{"zeta", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}], "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["v0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}], "+", 
       RowBox[{
        SuperscriptBox["u0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"2", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"h", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "+", 
       RowBox[{"eps", " ", 
        RowBox[{"zeta", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"v0", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"u0", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"2", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["v0", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["u0", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["v0", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"h", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["v0", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"h", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["u0", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"2", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "6"]}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"h", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "2"], "-", 
       RowBox[{"eps", " ", 
        RowBox[{"h", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{"zeta", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["eps", "2"], " ", 
        SuperscriptBox[
         RowBox[{"zeta", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}], "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["v0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "2", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}], "+", 
       RowBox[{
        SuperscriptBox["u0", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"h", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "+", 
       RowBox[{"eps", " ", 
        RowBox[{"zeta", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"v0", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "2"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"u0", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["u0", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["v0", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"h", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["v0", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "2", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{
         SuperscriptBox["h", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["u0", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"h", "[", 
         RowBox[{"x", ",", "y"}], "]"}], " ", 
        RowBox[{
         SuperscriptBox["u0", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGCwAmLjXzsOHX/4ypHr46uzILp5o+ItEL0lguMTiL7z8aLt
aSDd43WB5QyQflH69IfHo1eOmXO/s80E0n3Nib0g+vqGkLtzgPQlyRbehUB6
40XfSWeBNNPtuuDzQHqN0Mv7IHpRDb/gKyD9MH7H0jdAusxYcOUXIP2Hu8L5
y+NXjlOmVS4F0SFfjmwA0dKWAt5fgbTeVf5Jgk9eOe5jFCiTBtJxp36fAdGP
rj+YbvH0leOV3Ot/OZ69chR6GnzS7DmQf6FZJuPlK0eT4g8aIFo7+szaG0D6
nu2VryA68/Jzzm2vXjnKPr0ha8362tFkv0SgDZDeFzBX2hZI/zN1K3AE0jNe
sFWA6Ihgl71pQDooZferbCCd9T3WqQVId8ZxlYDomj9VShOB9J19j+eB6M/a
p4QmAWkjq/fp69leO9peFa+IYX/tuJRVRew6kC58ukPpBpCumyc/T50baJ79
dPlfQHqxvn3rEb7XjiHJjpu8+F879tZZySwQeO0oZeGrtx9IC7r7elwRe+34
Y6tHxAMgbX6xs2K1xGvHqr8dh0E0APQj+nI=
  "],
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Expand", "[", 
   RowBox[{"Uavg", "-", "Eqn3p21"}], "]"}], "//", "Simplify", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Verify", " ", "Eqn", " ", "3.21"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.60803274321719*^9, 3.6080327523332*^9}, {
  3.608032804988914*^9, 3.6080328303957577`*^9}, {3.6080349497904177`*^9, 
  3.608034950264975*^9}, {3.608035058451952*^9, 3.608035171568294*^9}, {
  3.608035228474299*^9, 3.608035254625573*^9}, {3.608042738328753*^9, 
  3.6080427479505873`*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.608032752787405*^9, {3.608032811957377*^9, 3.6080328310846*^9}, 
   3.60803312890586*^9, 3.608034645724792*^9, 3.608034840488525*^9, {
   3.608034929635294*^9, 3.6080349507934732`*^9}, 3.608035028153199*^9, {
   3.608035059766684*^9, 3.608035172023724*^9}, {3.608035218863357*^9, 
   3.6080352550991373`*^9}, 3.60804197083114*^9, 3.608043564553472*^9, 
   3.608048676983796*^9, 3.6082994631762037`*^9, 3.608463415742846*^9, 
   3.608464491052437*^9, 3.6084712747000113`*^9, 3.608479852156939*^9, 
   3.6085710264374933`*^9, 3.608574619969296*^9, 3.608575743288698*^9, 
   3.608629384489998*^9, 3.608634669790077*^9, 3.608651080573492*^9, 
   3.609174555854144*^9, 3.60917533980905*^9, 3.6091754301756067`*^9, 
   3.609176664532124*^9, 3.6092345765028667`*^9, 3.609254832581964*^9, 
   3.609255527903351*^9, 3.609838783055915*^9, 3.610265582737895*^9, 
   3.610883658627327*^9, 3.612033252125119*^9, 3.612033351550359*^9, 
   3.612263790393222*^9, 3.61226436664995*^9, 3.612717135274692*^9, 
   3.626621166783804*^9, 3.626623624779015*^9, 3.626625244921241*^9, 
   3.626634114202362*^9, 3.626634176221766*^9, 3.626710506141363*^9, 
   3.626721109970565*^9, 3.626770962943166*^9, 3.6267713603294888`*^9, 
   3.6267973318491373`*^9, 3.6267983271473494`*^9, 3.6267992543228683`*^9, 
   3.62738361548591*^9, 3.6277380487508497`*^9, 3.627989169135564*^9, 
   3.627991317785152*^9, 3.629726960996344*^9, 3.630158076731372*^9, 
   3.631621161984954*^9, 3.631895954049302*^9, 3.6325951698340054`*^9, 
   3.632658802421767*^9, 3.635847746424275*^9, 3.6358724502800703`*^9, 
   3.636812740486086*^9, 3.636813340286292*^9},
 FontSize->14]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Substitute", " ", "into", " ", "Hsaio"}], ",", " ", 
    RowBox[{"Eqn", " ", "2.17"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"H", " ", ":=", " ", 
    RowBox[{
     RowBox[{"h", "[", 
      RowBox[{"x", ",", "y"}], "]"}], "+", 
     RowBox[{"eps", " ", 
      RowBox[{"zeta", "[", 
       RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "+", 
      RowBox[{"eps", " ", 
       RowBox[{"zeta", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GovMass", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"zeta", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}], ",", "t"}], "]"}], "+", 
       RowBox[{"D2", "[", 
        RowBox[{"Uavec2", " ", "H"}], "]"}], "+", " ", 
       RowBox[{
        RowBox[{"mu", "^", "2"}], 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"D2", "[", 
           RowBox[{"H", " ", "Uavga"}], "]"}], "-", "  ", 
          RowBox[{"D2", "[", 
           RowBox[{"H", " ", "Uvec2v2za"}], "]"}]}], ")"}]}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.608040895382327*^9, 3.608040987098946*^9}, {
   3.6080410202728367`*^9, 3.60804111806316*^9}, {3.60804197491455*^9, 
   3.608041991784637*^9}, {3.608043447139282*^9, 3.608043453552791*^9}, {
   3.6080435705145283`*^9, 3.6080435728595877`*^9}, {3.608046057164446*^9, 
   3.6080460758346243`*^9}, {3.608046111460648*^9, 3.6080461874505787`*^9}, {
   3.6080462556028557`*^9, 3.6080462889789743`*^9}, {3.608046348129917*^9, 
   3.608046348306885*^9}, 3.608046381917383*^9, {3.6080464176490593`*^9, 
   3.608046430846162*^9}, {3.608046528549109*^9, 3.6080465316725063`*^9}, {
   3.608046655644662*^9, 3.608046670724782*^9}, {3.608047047509039*^9, 
   3.608047108593359*^9}, {3.608047461062049*^9, 3.608047464974124*^9}, {
   3.6080475524852743`*^9, 3.608047555978396*^9}, {3.608047898477563*^9, 
   3.6080479042783117`*^9}, {3.608047935775771*^9, 3.6080479509713173`*^9}, {
   3.608048321761771*^9, 3.608048334278837*^9}, {3.608048606700138*^9, 
   3.608048625955225*^9}, {3.608048661515473*^9, 3.608048724621415*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{"Eqn3p25", " ", "=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"zeta", "[", 
       RowBox[{"x", ",", "y", ",", "t"}], "]"}], ",", "t"}], "]"}], "+", 
    RowBox[{"D2", "[", 
     RowBox[{"H", " ", "Uavec2"}], "]"}], "-", 
    RowBox[{
     RowBox[{"mu", "^", "2"}], " ", 
     RowBox[{"D2", "[", 
      RowBox[{
       RowBox[{"H", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "6"}], ")"}], 
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"eps", "^", "2"}], " ", 
              RowBox[{
               RowBox[{"zeta", "[", 
                RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}]}], "-", 
             RowBox[{"eps", " ", 
              RowBox[{"zeta", "[", 
               RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
              RowBox[{"h", "[", 
               RowBox[{"x", ",", "y"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"h", "[", 
               RowBox[{"x", ",", "y"}], "]"}], "^", "2"}]}], ")"}]}], "-", 
          " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], " ", 
           RowBox[{
            RowBox[{"za", "[", 
             RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}]}]}], ")"}], 
        " ", 
        RowBox[{"G2", "[", 
         RowBox[{"D2", "[", "Uavec2", "]"}], "]"}]}], "+", 
       RowBox[{"H", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"eps", " ", 
              RowBox[{"zeta", "[", 
               RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "-", 
             RowBox[{"h", "[", 
              RowBox[{"x", ",", "y"}], "]"}]}], ")"}]}], "-", " ", 
          RowBox[{"za", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}], " ", 
        RowBox[{"G2", "[", 
         RowBox[{"D2", "[", 
          RowBox[{
           RowBox[{"h", "[", 
            RowBox[{"x", ",", "y"}], "]"}], " ", "Uavec2"}], "]"}], "]"}]}]}],
       "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.608041165578621*^9, 3.608041247602463*^9}, {
   3.608041312101233*^9, 3.6080414305777597`*^9}, 3.6080460533494797`*^9, {
   3.608046293501934*^9, 3.6080462949485693`*^9}, {3.6080467196523247`*^9, 
   3.608046783899248*^9}, {3.6080470245021152`*^9, 3.608047053651505*^9}, {
   3.6080471209055567`*^9, 3.6080471212968893`*^9}, {3.608047175856868*^9, 
   3.608047181847228*^9}, {3.6080472322613573`*^9, 3.60804723306321*^9}, {
   3.608047452926478*^9, 3.6080474881951847`*^9}, {3.60804752447198*^9, 
   3.608047526122394*^9}, {3.608047560863316*^9, 3.60804757250498*^9}, {
   3.60804764705831*^9, 3.608047660979261*^9}, {3.6080477052623453`*^9, 
   3.608047705836143*^9}, 3.608047954569027*^9, {3.608048188851553*^9, 
   3.608048202322791*^9}, {3.608048247342136*^9, 3.608048248910058*^9}, 
   3.6080486698676023`*^9, {3.608048727898789*^9, 3.608048738659774*^9}, {
   3.6084712612283487`*^9, 3.608471261232342*^9}},
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Verify", " ", "Eqn", " ", "3.25"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Eqn3p25", "-", "GovMass"}], " ", "]"}]}]], "Input",
 CellChangeTimes->{{3.6080414579501963`*^9, 3.608041464496911*^9}, {
   3.608046434838252*^9, 3.608046462476747*^9}, {3.6080468026391573`*^9, 
   3.608046875932538*^9}, {3.60804690915836*^9, 3.608046930860125*^9}, 
   3.6080469743593397`*^9, {3.6080475883186293`*^9, 3.608047611565736*^9}, {
   3.608047748382145*^9, 3.608047877725459*^9}, {3.6080479222590113`*^9, 
   3.608047922712409*^9}, {3.608047966650875*^9, 3.608047966731094*^9}, {
   3.60804825695706*^9, 3.608048277490074*^9}, {3.608048342277479*^9, 
   3.608048371351963*^9}, {3.608048644013013*^9, 3.608048655882985*^9}, {
   3.608048702209893*^9, 3.6080487171281557`*^9}},
 FontSize->14],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.608041465962845*^9, 3.608043421125155*^9, 3.608043463652685*^9, 
   3.608046198773861*^9, {3.608046270291678*^9, 3.608046298123136*^9}, 
   3.608046363812653*^9, 3.608046396541765*^9, 3.608046437503662*^9, 
   3.608046536821156*^9, {3.6080467886101923`*^9, 3.60804687663771*^9}, {
   3.608046913195266*^9, 3.6080469314816523`*^9}, 3.608046975164962*^9, {
   3.608047032161944*^9, 3.608047059630932*^9}, {3.608047112512157*^9, 
   3.608047127343704*^9}, 3.60804718704604*^9, 3.608047238157887*^9, 
   3.608047495043704*^9, 3.6080475315661592`*^9, {3.608047595039301*^9, 
   3.6080476125190287`*^9}, 3.608047651662179*^9, 3.608047711303235*^9, 
   3.608047753071514*^9, {3.608047793116476*^9, 3.608047878171392*^9}, {
   3.608047911673582*^9, 3.608047923366894*^9}, {3.608047961279755*^9, 
   3.608047967320208*^9}, 3.608048094937087*^9, 3.608048135280281*^9, 
   3.6080481934719753`*^9, {3.6080482319837112`*^9, 3.60804827815357*^9}, {
   3.608048326649335*^9, 3.6080483716873617`*^9}, {3.608048611309307*^9, 
   3.6080487462305403`*^9}, 3.608299465517192*^9, 3.608463417795577*^9, 
   3.608464492523678*^9, 3.608471276886978*^9, 3.60847985452284*^9, 
   3.60857102876289*^9, 3.608574621689273*^9, 3.6085757450135193`*^9, 
   3.608629386930655*^9, 3.6086346720961103`*^9, 3.6086510829230947`*^9, 
   3.609174558189415*^9, 3.609175342442762*^9, 3.609175432523676*^9, 
   3.609176666882297*^9, 3.609234578844717*^9, 3.609254835055894*^9, 
   3.609255530288415*^9, 3.6098387854298277`*^9, 3.610265585167059*^9, 
   3.6108836609637527`*^9, 3.612033254507792*^9, 3.612033353888254*^9, 
   3.6122637927981997`*^9, 3.612264369050308*^9, 3.612717137625668*^9, 
   3.6266211691739483`*^9, 3.6266236271731358`*^9, 3.6266252466661367`*^9, 
   3.626634116568774*^9, 3.6266341779544153`*^9, 3.626710508597733*^9, 
   3.626721112435769*^9, 3.62677096531667*^9, 3.626771362121204*^9, 
   3.626797334235112*^9, 3.6267983288815203`*^9, 3.626799256684273*^9, 
   3.627383617889233*^9, 3.6277380512176113`*^9, 3.627989171505768*^9, 
   3.627991320231051*^9, 3.629726963420567*^9, 3.630158079078163*^9, 
   3.631621164450727*^9, 3.631895956522977*^9, 3.6325951722168207`*^9, 
   3.6326588048416557`*^9, 3.635847748876086*^9, 3.6358724526790533`*^9, 
   3.636812742827632*^9, 3.636813342626848*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Compute", " ", "the", " ", "pressure"}], ",", " ", 
    RowBox[{"Eqn", " ", "3.26"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "w1f", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OrderExpansionM", "=", 
     RowBox[{"Expand", "[", 
      RowBox[{"Mom3Final", "/.", " ", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"u", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"u0", "[", 
              RowBox[{"#1", ",", "#2", ",", "#4"}], "]"}], "+", 
             RowBox[{
              RowBox[{"mu", "^", "2"}], " ", 
              RowBox[{"u1", "[", 
               RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}]}], 
            " ", "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"v", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"v0", "[", 
              RowBox[{"#1", ",", "#2", ",", "#4"}], "]"}], "+", 
             RowBox[{
              RowBox[{"mu", "^", "2"}], " ", 
              RowBox[{"v1", "[", 
               RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}]}], 
            " ", "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"w", "\[Rule]", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"mu", "^", "2"}], " ", 
             RowBox[{"w1f", "[", 
              RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}]}], "&"}],
            ")"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"rho", "\[Rule]", "1"}]}], "\[IndentingNewLine]", "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pzRule", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"OrderExpansionM", "\[Equal]", "0"}], ",", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], ",", "z"}], 
          "]"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{"pz", " ", "=", " ", 
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"eps", " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], ",", "z"}], 
          "]"}]}], " ", "/.", " ", "pzRule"}], ",", 
       RowBox[{"{", 
        RowBox[{"mu", ",", "0", ",", "2"}], "}"}]}], "]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.609843828141625*^9, 3.60984383099296*^9}, {
   3.6098438752569923`*^9, 3.609843877220924*^9}, {3.609843909911426*^9, 
   3.6098439935684032`*^9}, {3.6098440558883944`*^9, 3.60984409890946*^9}, {
   3.609844131378811*^9, 3.609844203128077*^9}, {3.609844237304966*^9, 
   3.609844293063554*^9}, {3.609844324512908*^9, 3.609844356827682*^9}, {
   3.609844418330823*^9, 3.6098446051555157`*^9}, 3.609844664580555*^9, {
   3.6098446968858128`*^9, 3.609844825357114*^9}, {3.609844877785946*^9, 
   3.6098448989819098`*^9}, {3.609844963293227*^9, 3.609844985811536*^9}, {
   3.609845047420281*^9, 3.609845080186592*^9}, 3.609845205078109*^9, 
   3.609856839812676*^9, 3.6098571040147133`*^9, 3.609857335987935*^9, {
   3.60985742651598*^9, 3.609857435779508*^9}, {3.60985747080637*^9, 
   3.609857476829158*^9}, {3.6098575161423607`*^9, 3.609857529908461*^9}, 
   3.6098576116928577`*^9, {3.609858372788904*^9, 3.609858403502986*^9}, {
   3.6098585308896627`*^9, 3.609858544625359*^9}, {3.626622180567124*^9, 
   3.626622207089197*^9}, {3.626622438262579*^9, 3.6266224806297483`*^9}, 
   3.626622524520961*^9, {3.626622594593795*^9, 3.6266226010563498`*^9}, 
   3.626622791973545*^9, {3.626622832432378*^9, 3.6266228335180264`*^9}, 
   3.626623808705123*^9, 3.6266238545782022`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", 
  RowBox[{
   SuperscriptBox["mu", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "eps"}], " ", 
      RowBox[{
       SuperscriptBox["w1f", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["eps", "2"], " ", 
      RowBox[{"w1f", "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["w1f", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["eps", "2"], " ", 
      RowBox[{"v0", "[", 
       RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["w1f", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["eps", "2"], " ", 
      RowBox[{"u0", "[", 
       RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
      RowBox[{
       SuperscriptBox["w1f", 
        TagBox[
         RowBox[{"(", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], ")"}],
         Derivative],
        MultilineFunction->None], "[", 
       RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.609845061037393*^9, 3.609845163698862*^9, 3.609845205685698*^9, 
   3.609856840748178*^9, 3.609856910274906*^9, 3.609857104828578*^9, 
   3.609857337476264*^9, 3.6098574375894012`*^9, 3.609857477373638*^9, 
   3.6098575321265907`*^9, 3.6098576136370068`*^9, 3.6098576603207693`*^9, {
   3.609858374577756*^9, 3.6098584042057953`*^9}, 3.6102655852940617`*^9, 
   3.6108836611154737`*^9, 3.6120332546043053`*^9, 3.6120333539937162`*^9, 
   3.6122637929030113`*^9, 3.612264369109981*^9, 3.612717137692999*^9, 
   3.626621169236887*^9, 3.6266222078280277`*^9, {3.626622440141653*^9, 
   3.626622481031094*^9}, 3.626622525085362*^9, {3.626622701028757*^9, 
   3.626622722591249*^9}, 3.626622792696725*^9, 3.6266228340890636`*^9, 
   3.626623627213228*^9, 3.62662380965454*^9, 3.626623857071639*^9, 
   3.626625246697915*^9, 3.626634116620996*^9, 3.626634177987714*^9, 
   3.6267105086365347`*^9, 3.626721112481823*^9, 3.6267709653960876`*^9, 
   3.6267713621625957`*^9, 3.626797334311428*^9, 3.6267983289130173`*^9, 
   3.62679925672412*^9, 3.627383617988809*^9, 3.6277380513020163`*^9, 
   3.627989171591031*^9, 3.627991320304214*^9, 3.629726963542343*^9, 
   3.630158079175683*^9, 3.631621164551421*^9, 3.631895956622343*^9, 
   3.632595172329773*^9, 3.632658804949779*^9, 3.635847749009759*^9, 
   3.6358724527868958`*^9, 3.6368127429560947`*^9, 3.6368133426686363`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "We", " ", "are", " ", "only", " ", "interested", " ", "in", " ", "terms",
      " ", "containing", " ", 
     RowBox[{"mu", "^", "2"}], " ", "or", " ", "less"}], ",", " ", 
    RowBox[{
    "and", " ", "w1", " ", "already", " ", "brings", " ", "in", " ", "a", " ", 
     RowBox[{"mu", "^", "2."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Pressure", "=", 
    RowBox[{"Expand", "[", 
     RowBox[{
      RowBox[{"Integrate", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"-", "eps"}], " ", 
          RowBox[{"mu", "^", "2"}], " ", "0", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"R0", "[", 
             RowBox[{"x", ",", "y"}], "]"}], "+", 
            RowBox[{
             RowBox[{"R1", "[", 
              RowBox[{"x", ",", "y"}], "]"}], " ", "z"}], "+", 
            RowBox[{
             RowBox[{"R2", "[", 
              RowBox[{"x", ",", "y"}], "]"}], " ", 
             RowBox[{"z", "^", "2"}]}]}], ")"}], " ", 
          RowBox[{"w1", "[", 
           RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}]}], " ", 
         RowBox[{"(*", "friction", "*)"}], "\[IndentingNewLine]", "+", 
         RowBox[{"(", 
          RowBox[{"pz", " ", "/.", " ", 
           RowBox[{"w1f", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"w1", "[", 
               RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "]"}], "&"}], 
             ")"}]}]}], ")"}]}], "\[IndentingNewLine]", ",", "z"}], "]"}], 
      "/", "eps"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.608300568796925*^9, 3.608300831610839*^9}, 
   3.6083012168289843`*^9, {3.608301313725793*^9, 3.60830131559158*^9}, {
   3.608301351594771*^9, 3.608301388611411*^9}, {3.608301429718149*^9, 
   3.608301456932671*^9}, {3.608301516409216*^9, 3.6083015858247633`*^9}, {
   3.6083016262956123`*^9, 3.6083016396194153`*^9}, 3.60830170730764*^9, {
   3.60830407704986*^9, 3.608304099900745*^9}, {3.6083041364407263`*^9, 
   3.60830419516049*^9}, {3.608304240343276*^9, 3.608304288859644*^9}, 
   3.608304382353754*^9, {3.608304584674081*^9, 3.6083045859462023`*^9}, {
   3.608304685376143*^9, 3.608304687590042*^9}, {3.6083054671281567`*^9, 
   3.608305467271875*^9}, {3.608305879103231*^9, 3.60830593880554*^9}, {
   3.6084633048152657`*^9, 3.60846330611276*^9}, {3.608463821281096*^9, 
   3.6084638224450293`*^9}, {3.608464444111229*^9, 3.6084644496590977`*^9}, {
   3.608464505336082*^9, 3.608464530716812*^9}, {3.6084647791652718`*^9, 
   3.608464789408299*^9}, {3.6266250997384872`*^9, 3.626625128206917*^9}, {
   3.626625187730627*^9, 3.626625191353115*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Fix", " ", "constant", " ", "of", " ", "integration"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Pressure2", "=", 
    RowBox[{"Pressure", "-", 
     RowBox[{"(", 
      RowBox[{"Pressure", " ", "/.", " ", 
       RowBox[{"z", "\[Rule]", 
        RowBox[{
         RowBox[{"zeta", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}], "eps"}]}]}], ")"}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.6083042086416597`*^9, 3.608304212877397*^9}, {
   3.608304272890254*^9, 3.608304330769679*^9}, 3.608304386678195*^9, {
   3.608304767644665*^9, 3.608304768905364*^9}, 3.608304956932976*^9, 
   3.608305975156851*^9, 3.608463513525888*^9, {3.626628005388215*^9, 
   3.626628010375856*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{"Eqn3p28", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"zeta", "[", 
       RowBox[{"x", ",", "y", ",", "t"}], "]"}], "-", 
      RowBox[{"z", "/", "eps"}]}], ")"}], "+", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mu", "^", "2"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"z", "^", "2"}], "-", 
          RowBox[{
           RowBox[{"eps", "^", "2"}], " ", 
           RowBox[{
            RowBox[{"zeta", "[", 
             RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}]}]}], ")"}], 
        " ", 
        RowBox[{"D2", "[", 
         RowBox[{"D", "[", 
          RowBox[{"U0vec2", ",", "t"}], "]"}], "]"}]}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z", "-", 
          RowBox[{"eps", " ", 
           RowBox[{"zeta", "[", 
            RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}], 
        RowBox[{"D2", "[", 
         RowBox[{
          RowBox[{"h", "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", 
          RowBox[{"D", "[", 
           RowBox[{"U0vec2", ",", "t"}], "]"}]}], "]"}]}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], " ", "eps", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"z", "^", "2"}], "-", 
          RowBox[{
           RowBox[{"eps", "^", "2"}], " ", 
           RowBox[{
            RowBox[{"zeta", "[", 
             RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}]}]}], ")"}], 
        " ", 
        RowBox[{"DG2", "[", 
         RowBox[{"U0vec2", ",", 
          RowBox[{"D2", "[", "U0vec2", "]"}]}], "]"}]}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{"eps", "  ", 
        RowBox[{"(", 
         RowBox[{"z", "-", 
          RowBox[{"eps", " ", 
           RowBox[{"zeta", "[", 
            RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ")"}], " ", 
        RowBox[{"DG2", "[", 
         RowBox[{"U0vec2", ",", 
          RowBox[{"D2", "[", 
           RowBox[{
            RowBox[{"h", "[", 
             RowBox[{"x", ",", "y"}], "]"}], " ", "U0vec2"}], "]"}]}], 
         "]"}]}], "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], " ", "eps", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"eps", "^", "2"}], " ", 
           RowBox[{
            RowBox[{"zeta", "[", 
             RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}]}], "-", 
          RowBox[{"z", "^", "2"}]}], ")"}], 
        RowBox[{
         RowBox[{"D2", "[", "U0vec2", "]"}], "^", "2"}]}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{"eps", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"eps", " ", 
           RowBox[{"zeta", "[", 
            RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "-", "z"}], ")"}], 
        " ", 
        RowBox[{"D2", "[", 
         RowBox[{
          RowBox[{"h", "[", 
           RowBox[{"x", ",", "y"}], "]"}], " ", "U0vec2"}], "]"}], " ", 
        RowBox[{"D2", "[", "U0vec2", "]"}]}]}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.608305222335178*^9, 3.6083053703954983`*^9}, {
   3.608305479727254*^9, 3.608305481533036*^9}, {3.608463587968128*^9, 
   3.608463603487384*^9}, {3.608463643535266*^9, 3.6084637949421997`*^9}, {
   3.608463839261568*^9, 3.608463847091793*^9}, 3.6084639873355618`*^9, {
   3.608464054492958*^9, 3.60846405690208*^9}, {3.608464180559225*^9, 
   3.60846427675134*^9}, {3.608464317921282*^9, 3.608464340401896*^9}, {
   3.608464456361108*^9, 3.608464465525551*^9}, {3.60846465584995*^9, 
   3.608464658301632*^9}, {3.608464702749873*^9, 3.608464732419197*^9}},
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"Pressure2", " ", "-", " ", "Eqn3p28"}], " ", "]"}]], "Input",
 CellChangeTimes->{{3.608305957481885*^9, 3.6083059657585487`*^9}, {
  3.608463920215324*^9, 3.608463979173799*^9}},
 FontSize->14],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.608305966436697*^9, 3.608463418363591*^9, 3.6084637581457977`*^9, {
   3.60846380014725*^9, 3.6084638509813766`*^9}, {3.608463923560258*^9, 
   3.6084639796574383`*^9}, 3.608464061967499*^9, {3.608464199968255*^9, 
   3.608464280272044*^9}, 3.6084643440979347`*^9, {3.60846447436117*^9, 
   3.608464492757704*^9}, 3.608464536073358*^9, {3.608464708684869*^9, 
   3.608464734863823*^9}, 3.60846480462733*^9, 3.608471277190661*^9, 
   3.608479854768363*^9, 3.608571028960781*^9, 3.6085746218807096`*^9, 
   3.608575745211268*^9, 3.608629387174406*^9, 3.608634672288197*^9, 
   3.608651083119972*^9, 3.609174558396344*^9, 3.6091753427619658`*^9, 
   3.609175432774508*^9, 3.609176667088646*^9, 3.60923457904889*^9, 
   3.60925483527989*^9, 3.609255530509787*^9, 3.609838785628882*^9, 
   3.610265585899377*^9, 3.610883661850089*^9, 3.612033255204015*^9, 
   3.612033354639786*^9, 3.6122637936232*^9, 3.6122643693229*^9, 
   3.612717137913733*^9, 3.6266211694538517`*^9, 3.6266236274636602`*^9, 
   3.6266237587441397`*^9, 3.626625137132331*^9, 3.626625197086684*^9, 
   3.626625246983151*^9, 3.6266341170114317`*^9, 3.626634178324078*^9, 
   3.6267105089169188`*^9, 3.626721112761791*^9, 3.6267709656695137`*^9, 
   3.626771362436249*^9, 3.62679733461014*^9, 3.62679832918008*^9, 
   3.626799256985755*^9, 3.6273836183228703`*^9, 3.627738051589265*^9, 
   3.627989171877511*^9, 3.627991320574498*^9, 3.629726963912037*^9, 
   3.6301580794719887`*^9, 3.631621164876326*^9, 3.631895956894199*^9, 
   3.632595172616188*^9, 3.632658805285761*^9, 3.635847749359037*^9, 
   3.6358724530945663`*^9, 3.636812743238886*^9, 3.636813342938505*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Compute", " ", "the", " ", 
    RowBox[{"curl", ".", " ", "We"}], " ", "are", " ", "assuming", " ", 
    "terms", " ", "of", " ", "order", " ", 
    RowBox[{"mu", "^", "2"}], " ", "are", " ", 
    RowBox[{"unimportant", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"curlfree", " ", "=", " ", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{"Curl", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Uvec2v3", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"Uvec2v3", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}], ",", "Coords"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"mu", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.608481198680295*^9, 3.608481333003797*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "mu", "]"}], "2"],
    SeriesData[$CellContext`mu, 0, {}, 2, 2, 1],
    Editable->False], ",", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "mu", "]"}], "2"],
    SeriesData[$CellContext`mu, 0, {}, 2, 2, 1],
    Editable->False], ",", 
   InterpretationBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         SuperscriptBox["ua", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox["va", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}], "+", 
     InterpretationBox[
      SuperscriptBox[
       RowBox[{"O", "[", "mu", "]"}], "2"],
      SeriesData[$CellContext`mu, 0, {}, 0, 2, 1],
      Editable->False]}],
    SeriesData[$CellContext`mu, 
     0, {-Derivative[
        0, 1, 0][$CellContext`ua][$CellContext`x, $CellContext`y, \
$CellContext`t] + 
      Derivative[
       1, 0, 0][$CellContext`va][$CellContext`x, $CellContext`y, \
$CellContext`t]}, 0, 2, 1],
    Editable->False]}], "}"}]], "Output",
 CellChangeTimes->{{3.608481245106564*^9, 3.608481273136099*^9}, 
   3.6085710290197*^9, 3.608574621902568*^9, 3.608575745230592*^9, 
   3.6086293872299767`*^9, 3.608634672330665*^9, 3.608651083160062*^9, 
   3.609174558460511*^9, 3.609175342853938*^9, 3.609175432861672*^9, 
   3.609176667137087*^9, 3.609234579111292*^9, 3.609254835361713*^9, 
   3.609255530568245*^9, 3.6098387856825047`*^9, 3.610265585926229*^9, 
   3.610883661888167*^9, 3.612033255238987*^9, 3.612033354673016*^9, 
   3.612263793660437*^9, 3.612264369354287*^9, 3.6127171379521503`*^9, 
   3.626621169526374*^9, 3.626623627499794*^9, 3.626625247012974*^9, 
   3.6266341170539*^9, 3.626634178355928*^9, 3.6267105089611073`*^9, 
   3.626721112825931*^9, 3.626770965720107*^9, 3.626771362479766*^9, 
   3.6267973346536503`*^9, 3.626798329211814*^9, 3.626799257016889*^9, 
   3.627383618344161*^9, 3.6277380516254263`*^9, 3.6279891719121943`*^9, 
   3.6279913206073847`*^9, 3.629726963939148*^9, 3.6301580795195837`*^9, 
   3.631621164933119*^9, 3.6318959569655247`*^9, 3.632595172670548*^9, 
   3.6326588053225107`*^9, 3.635847749414774*^9, 3.635872453142523*^9, 
   3.636812743333054*^9, 3.63681334297815*^9},
 FontSize->14]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Just", " ", "some", " ", "functions", " ", "to", " ", "play", " ", 
    "with"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"OrderMuEps", "[", "xx_", "]"}], " ", ":=", " ", 
     RowBox[{"Expand", "[", 
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{"xx", ",", 
         RowBox[{"{", 
          RowBox[{"mu", ",", "0", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"eps", ",", "0", ",", "3"}], "}"}]}], "]"}], "]"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ZaInd", "[", "xx_", "]"}], " ", ":=", " ", 
     RowBox[{"xx", " ", "/.", " ", 
      RowBox[{"{", 
       RowBox[{"za", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"za", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], " ", "&"}], ")"}]}], "}"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.608472803312147*^9, 3.6084728727026577`*^9}, {
   3.608473126024089*^9, 3.608473157330991*^9}, {3.608473202115106*^9, 
   3.608473214358293*^9}, {3.608473433309951*^9, 3.60847343903448*^9}, 
   3.608483419921051*^9, {3.608485663671165*^9, 3.6084856807316647`*^9}, {
   3.626625435712657*^9, 3.626625448520664*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Governing", " ", "equations", " ", "for", " ", "u", " ", "and", " ", 
     "v"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"based", " ", "on", " ", "Eqn", " ", "2.4"}], ":", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"u", ",", "t"}], "]"}], "+", 
       RowBox[{"eps", " ", "u", " ", "dot", " ", 
        RowBox[{"Grad", "[", "u", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"eps", "/", 
          RowBox[{"mu", "^", "2"}]}], ")"}], " ", "w", " ", 
        RowBox[{"D", "[", 
         RowBox[{"u", ",", "z"}], "]"}]}], " ", "+", " ", 
       RowBox[{"Grad", "[", "p", "]"}]}], " ", "\[Equal]", " ", 
      RowBox[{
      "0", "\[IndentingNewLine]", "ZeroToA", " ", "converts", " ", "u0"}]}]}],
     ",", 
    RowBox[{"v0", " ", "to", " ", "ua"}], ",", 
    RowBox[{"va", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Pressure2a", " ", "=", " ", 
     RowBox[{"ZeroToA", "[", 
      RowBox[{"Simplify", "[", "Pressure2", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GovMomRaw", "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"Uvec2v3", ",", "t"}], "]"}], "+", "\[IndentingNewLine]", 
      RowBox[{"eps", " ", 
       RowBox[{"Normal", "[", 
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{"DG2", "[", 
           RowBox[{"Uvec2v3", ",", "Uvec2v3"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"mu", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}]}], "+", 
      " ", "\[IndentingNewLine]", 
      RowBox[{"eps", " ", 
       RowBox[{"ZeroToA", "[", 
        RowBox[{"w1", "[", 
         RowBox[{"x", ",", "y", ",", "z", ",", "t"}], "]"}], "]"}], " ", 
       RowBox[{"D", "[", 
        RowBox[{"Uvec2v3", ",", "z"}], "]"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{"G2", "[", "Pressure2a", "]"}]}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GovMom", " ", "=", " ", 
     RowBox[{"GovMomRaw", "/.", " ", 
      RowBox[{"z", "\[Rule]", 
       RowBox[{"za", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.608466821048047*^9, 3.608466931193453*^9}, {
   3.608466964016428*^9, 3.608467031839958*^9}, 3.608467980297521*^9, {
   3.6084714304669657`*^9, 3.608471443320918*^9}, 3.608471730742426*^9, {
   3.608472024147492*^9, 3.608472027582231*^9}, {3.608472074910759*^9, 
   3.608472075422723*^9}, {3.6084724427076807`*^9, 3.6084725858746767`*^9}, {
   3.608472760145711*^9, 3.6084727787903433`*^9}, {3.608472849465026*^9, 
   3.60847289677617*^9}, {3.608473162418068*^9, 3.6084731715937634`*^9}, {
   3.608473218266942*^9, 3.6084732302125397`*^9}, {3.608480798489606*^9, 
   3.608480809429126*^9}, {3.6084808414325647`*^9, 3.608480865640909*^9}, {
   3.6084809114610987`*^9, 3.608481057061378*^9}, {3.6084814670879793`*^9, 
   3.6084814716643047`*^9}, {3.6084832043732557`*^9, 
   3.6084832052122297`*^9}, {3.608483255440057*^9, 3.6084833100558577`*^9}, {
   3.608483358782914*^9, 3.608483438122284*^9}, {3.6084835294840813`*^9, 
   3.608483627302023*^9}, 3.6084837577092733`*^9, {3.608483800083498*^9, 
   3.608483825893085*^9}, {3.608483868456461*^9, 3.6084838760748043`*^9}, {
   3.6084839773349657`*^9, 3.608483999384799*^9}, {3.608485289672709*^9, 
   3.6084853104387283`*^9}, {3.608485693333468*^9, 3.608485699020719*^9}, {
   3.6084857364659986`*^9, 3.608485768681313*^9}, 3.608486821486788*^9, 
   3.608486855296308*^9, {3.60848688581933*^9, 3.608486888869515*^9}, {
   3.608487062353692*^9, 3.6084870907817183`*^9}, {3.608574097975965*^9, 
   3.6085741110835257`*^9}, {3.60857415701296*^9, 3.608574178858515*^9}, {
   3.608574319127823*^9, 3.608574323940235*^9}, {3.608574589086958*^9, 
   3.6085745900914307`*^9}, {3.608574725250276*^9, 3.6085747265462933`*^9}, 
   3.608574848543298*^9, 3.608575866788431*^9, {3.60857594772668*^9, 
   3.6085760223517103`*^9}, {3.608576059338058*^9, 3.608576092167336*^9}, {
   3.608629438467556*^9, 3.6086294494625177`*^9}, {3.626625468661868*^9, 
   3.626625475549973*^9}, {3.626625543326604*^9, 3.6266255688207283`*^9}, {
   3.626625660534683*^9, 3.626625693869014*^9}, {3.626710747851*^9, 
   3.626710756068231*^9}, {3.626797567831571*^9, 3.626797600596489*^9}, {
   3.626800631923326*^9, 3.62680064980462*^9}, 3.627989660496752*^9, {
   3.627989831851787*^9, 3.627989851907053*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{"HasMu4", "[", "xx_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{
     RowBox[{"Series", "[", 
      RowBox[{"xx", ",", 
       RowBox[{"{", 
        RowBox[{"mu", ",", "0", ",", "4"}], "}"}]}], "]"}], ",", 
     RowBox[{"mu", "^", "4"}]}], "]"}], " ", "=!=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.627989665294112*^9, 3.627989695128552*^9}, {
  3.62798972746944*^9, 3.627989750046*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"HasMu4", "[", "GovMomRaw", "]"}]], "Input",
 CellChangeTimes->{{3.627989700609357*^9, 3.627989713168542*^9}, {
  3.627989744709827*^9, 3.627989794393238*^9}, {3.627989860074811*^9, 
  3.62798986272915*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.6279897082307997`*^9, 3.627989795234717*^9}, 
   3.627989863326726*^9, 3.627991321933585*^9, 3.629726964788885*^9, 
   3.6301580803425922`*^9, 3.63162116580446*^9, 3.631895957832492*^9, 
   3.6325951735154257`*^9, 3.632658806156006*^9, 3.635847750407813*^9, 
   3.635872453958708*^9, 3.6368127442214947`*^9, 3.6368133438022633`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "zavg", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zavg", "[", "n_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"zavg", "[", "n", "]"}], " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"z", "^", "n"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{"-", 
          RowBox[{"h", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], ",", 
         RowBox[{"zeta", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "}"}]}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "+", 
       RowBox[{"zeta", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}]}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.627384676354463*^9, 3.627384732393498*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"exp1", "=", 
   RowBox[{"Expand", "[", "GovMomRaw", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coef0", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"exp1", " ", "/.", " ", 
     RowBox[{"z", "\[Rule]", "0"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coef1", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"exp1", " ", "-", "coef0"}], ")"}], "/", "z"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.627383921939608*^9, 3.627384133026802*^9}, {
   3.627384167381268*^9, 3.627384195095077*^9}, {3.6273842527983522`*^9, 
   3.627384400800201*^9}, {3.627384452359118*^9, 3.6273844527468023`*^9}, {
   3.6273845307280903`*^9, 3.6273846217143497`*^9}, {3.627384906358531*^9, 
   3.627384908721739*^9}, {3.627738237765361*^9, 3.627738270713861*^9}, 
   3.627738350810555*^9, 3.627738505297407*^9, {3.627739033311108*^9, 
   3.627739098946419*^9}, 3.627739129611452*^9, {3.6277391847424498`*^9, 
   3.627739317179759*^9}, {3.627989927983924*^9, 3.62798993398822*^9}, {
   3.627990139568203*^9, 3.627990142700611*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GovMomSeries", " ", "=", " ", 
   RowBox[{"coef0", " ", "+", " ", 
    RowBox[{"coef1", "  ", "z"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.627384986061105*^9, 3.6273850018727503`*^9}, 
   3.627738354992971*^9, {3.627738463841325*^9, 3.62773846395919*^9}, 
   3.6277384992454042`*^9, {3.6277393390037613`*^9, 3.627739339175528*^9}, 
   3.6279901458943567`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Eqn", " ", "3.30"}], ",", " ", 
    RowBox[{
     RowBox[{"appears", " ", "to", " ", "rely", " ", "on", " ", 
      RowBox[{"D", "[", 
       RowBox[{"za", ",", "t"}], "]"}]}], " ", "=", " ", "0"}]}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Eqn3p30", " ", "=", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"eps", "^", "3"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"mu", "^", "2"}], " ", 
         RowBox[{"G2", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], " ", 
           RowBox[{
            RowBox[{"zeta", "[", 
             RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"D2", "[", "Uavec2", "]"}], "^", "2"}], "-", 
             RowBox[{"DG2", "[", 
              RowBox[{"Uavec2", ",", " ", 
               RowBox[{"D2", "[", "Uavec2", "]"}]}], "]"}]}], ")"}]}], 
          "]"}]}], ")"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eps", "^", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"mu", "^", "2"}], " ", 
         RowBox[{"G2", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}]}], " ", 
            RowBox[{
             RowBox[{"zeta", "[", 
              RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}], " ", 
            RowBox[{"D2", "[", 
             RowBox[{"D", "[", 
              RowBox[{"Uavec2", ",", "t"}], "]"}], "]"}]}], "-", " ", 
           RowBox[{
            RowBox[{"zeta", "[", 
             RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
            RowBox[{"DG2", "[", 
             RowBox[{"Uavec2", ",", 
              RowBox[{"D2", "[", 
               RowBox[{
                RowBox[{"h", "[", 
                 RowBox[{"x", ",", "y"}], "]"}], " ", "Uavec2"}], "]"}]}], 
             "]"}]}], "+", " ", 
           RowBox[{
            RowBox[{"zeta", "[", 
             RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
            RowBox[{"D2", "[", "Uavec2", "]"}], " ", 
            RowBox[{"D2", "[", 
             RowBox[{
              RowBox[{"h", "[", 
               RowBox[{"x", ",", "y"}], "]"}], " ", "Uavec2"}], "]"}]}]}], 
          "]"}]}], ")"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"Uavec2", ",", "t"}], "]"}], "+", 
        RowBox[{"G2", "[", 
         RowBox[{"zeta", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}], "]"}], " ", "+", 
        RowBox[{
         RowBox[{"mu", "^", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], " ", 
            RowBox[{
             RowBox[{"za", "[", 
              RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}], " ", 
            RowBox[{"G2", "[", 
             RowBox[{"D2", "[", 
              RowBox[{"D", "[", 
               RowBox[{"Uavec2", ",", "t"}], "]"}], "]"}], "]"}]}], "+", " ", 
           
           RowBox[{
            RowBox[{"za", "[", 
             RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
            RowBox[{"G2", "[", 
             RowBox[{"D2", "[", 
              RowBox[{
               RowBox[{"h", "[", 
                RowBox[{"x", ",", "y"}], "]"}], " ", 
               RowBox[{"D", "[", 
                RowBox[{"Uavec2", ",", "t"}], "]"}]}], "]"}], "]"}]}]}], 
          ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
      RowBox[{"eps", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"DG2", "[", 
          RowBox[{"Uavec2", ",", "Uavec2"}], "]"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mu", "^", "2"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "2"}], ")"}], " ", 
            RowBox[{
             RowBox[{"za", "[", 
              RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}], " ", 
            RowBox[{"G2", "[", 
             RowBox[{"DG2", "[", 
              RowBox[{"Uavec2", ",", 
               RowBox[{"D2", "[", "Uavec2", "]"}]}], "]"}], "]"}]}], ")"}]}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mu", "^", "2"}], " ", 
          RowBox[{"za", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{"DG2", "[", 
           RowBox[{"Uavec2", ",", 
            RowBox[{"za", "[", 
             RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "]"}], " ", 
          RowBox[{"G2", "[", 
           RowBox[{"D2", "[", "Uavec2", "]"}], "]"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mu", "^", "2"}], " ", 
          RowBox[{"za", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
          RowBox[{"G2", "[", 
           RowBox[{"DG2", "[", 
            RowBox[{"Uavec2", ",", 
             RowBox[{"D2", "[", 
              RowBox[{
               RowBox[{"h", "[", 
                RowBox[{"x", ",", "y"}], "]"}], " ", "Uavec2"}], "]"}]}], 
            "]"}], "]"}]}], "+", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mu", "^", "2"}], " ", 
          RowBox[{"DG2", "[", 
           RowBox[{"Uavec2", ",", 
            RowBox[{"za", "[", 
             RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "]"}], " ", 
          RowBox[{"G2", "[", 
           RowBox[{"D2", "[", 
            RowBox[{
             RowBox[{"h", "[", 
              RowBox[{"x", ",", "y"}], "]"}], " ", "Uavec2"}], "]"}], "]"}]}],
          "+", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mu", "^", "2"}], " ", 
          RowBox[{"G2", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "/", "2"}], ")"}], " ", 
             RowBox[{
              RowBox[{"D2", "[", 
               RowBox[{
                RowBox[{"h", "[", 
                 RowBox[{"x", ",", "y"}], "]"}], " ", "Uavec2"}], "]"}], "^", 
              "2"}]}], "-", 
            RowBox[{
             RowBox[{"zeta", "[", 
              RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
             RowBox[{"D2", "[", 
              RowBox[{
               RowBox[{"h", "[", 
                RowBox[{"x", ",", "y"}], "]"}], " ", 
               RowBox[{"D", "[", 
                RowBox[{"Uavec2", ",", "t"}], "]"}]}], "]"}]}]}], "]"}]}]}], 
        ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Eqn3p30verify", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Eqn3p30", "-", "GovMom"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ZaInd", "[", "Eqn3p30verify", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.608574975882173*^9, 3.608575057788253*^9}, {
   3.608575098847019*^9, 3.6085751028486233`*^9}, {3.608575138778872*^9, 
   3.6085751420873013`*^9}, {3.608575175422131*^9, 3.608575207647593*^9}, {
   3.608575641506122*^9, 3.608575656836692*^9}, {3.6085759021110363`*^9, 
   3.608575908967025*^9}, 3.60857598076399*^9, {3.6086294838499804`*^9, 
   3.608629528464637*^9}, {3.6086295962265177`*^9, 3.608629656314246*^9}, {
   3.608629699639804*^9, 3.608629744034397*^9}, {3.6086298963332157`*^9, 
   3.6086299225999813`*^9}, {3.6086299566521063`*^9, 
   3.6086300070891113`*^9}, {3.626710534224163*^9, 3.626710588369397*^9}, {
   3.627994169967675*^9, 3.627994189827681*^9}, 3.636813158875977*^9},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.6085750030261602`*^9, 3.6085750266256657`*^9}, 
   3.60857506458394*^9, 3.608575106630303*^9, 3.60857514682017*^9, {
   3.60857518120002*^9, 3.608575208358654*^9}, 3.6085757454859343`*^9, {
   3.608575875889185*^9, 3.6085759262104816`*^9}, {3.608575981409449*^9, 
   3.60857600647771*^9}, {3.6085760369698153`*^9, 3.608576063641404*^9}, 
   3.6086293880859623`*^9, {3.608629465100395*^9, 3.608629489245961*^9}, {
   3.608629598238613*^9, 3.6086296571814213`*^9}, 3.60862971910585*^9, 
   3.608629923196026*^9, {3.608629981234784*^9, 3.6086299883301363`*^9}, 
   3.608634673029543*^9, 3.608651083873185*^9, 3.6091745591857977`*^9, 
   3.609175343867415*^9, 3.6091754338242083`*^9, 3.609176667850666*^9, 
   3.6092345798325043`*^9, 3.609254836259465*^9, 3.6092555320827637`*^9, 
   3.60983878639613*^9, 3.6102655866954813`*^9, 3.610883662641282*^9, 
   3.612033256045113*^9, 3.612033355462438*^9, 3.6122637944995213`*^9, 
   3.6122643701209517`*^9, 3.61271713882656*^9, 3.626621170423739*^9, 
   3.6266236283550653`*^9, 3.626625247279079*^9, 3.6266256041728687`*^9, 
   3.626634117844363*^9, 3.6266341786545753`*^9, 3.6267105098373137`*^9, {
   3.626710561066*^9, 3.626710590788288*^9}, 3.6267211136806183`*^9, 
   3.626770966558131*^9, 3.6267713627658043`*^9, 3.6267973354944983`*^9, 
   3.626798329486079*^9, 3.626799257840107*^9, 3.6273836190946293`*^9, 
   3.627738104062963*^9, 3.627991339289027*^9, {3.6279941720789957`*^9, 
   3.627994190294818*^9}, 3.629726982204192*^9, 3.630158109973605*^9, 
   3.631621184693099*^9, 3.6318959765024033`*^9, 3.632595192436507*^9, 
   3.632658824881084*^9, 3.63584776870329*^9, 3.635872479829507*^9, 
   3.636812770317533*^9, 3.63681316107521*^9, 3.6368133475162582`*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Now", " ", "compare", " ", "our", " ", "results", " ", "with", " ", 
    "what", " ", "is", " ", "written", " ", "in", " ", 
    RowBox[{"Dr", ".", " ", "Fengyan"}], " ", 
    RowBox[{"Shi", "'"}], "s", " ", "Funwave", " ", "TVD", " ", 
    RowBox[{"manual", ".", " ", "Consider"}], " ", "Shi", " ", "Eqn", " ", 
    "2"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ShiA", " ", "=", " ", 
     RowBox[{"D2", "[", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"x", ",", "y"}], "]"}], " ", "Uavec2"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ShiB", " ", "=", " ", 
     RowBox[{"D2", "[", "Uavec2", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GshiA", " ", "=", " ", 
     RowBox[{"G2", "[", "ShiA", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GshiB", " ", "=", " ", 
     RowBox[{"G2", "[", "ShiB", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"za", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}], "-", "z"}], ")"}], " ", 
       "GshiA"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"za", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}], "-", 
         RowBox[{"z", "^", "2"}]}], ")"}], " ", "GshiB"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ushi", " ", "=", " ", 
     RowBox[{"Uavec2", "+", 
      RowBox[{
       RowBox[{"mu", "^", "2"}], " ", "u2"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ushi3", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ushi", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"ushi", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ushi3m", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"u2", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "builds", " ", "the", " ", "connection", " ", "between", " ",
      "Hsaio", " ", "and", " ", "Shi"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Uvec2v3", "-", "ushi"}], ")"}], " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mu", "\[Rule]", "1"}], ",", 
       RowBox[{"eps", "\[Rule]", "1"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.608631099335627*^9, 3.608631304258432*^9}, {
   3.608631405669466*^9, 3.6086314357075977`*^9}, {3.608632639870191*^9, 
   3.60863268844464*^9}, {3.626711735042224*^9, 3.6267117511619673`*^9}, {
   3.626712275027274*^9, 3.626712314334076*^9}, {3.626717343153726*^9, 
   3.626717367982354*^9}, {3.6267174316278353`*^9, 3.626717441266*^9}, {
   3.626771268296567*^9, 3.626771295420849*^9}, 3.6267713957455397`*^9, {
   3.636813176705674*^9, 3.636813199600842*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.6086312655950108`*^9, 3.6086313047436647`*^9}, 
   3.60863143775959*^9, 3.6086326892099752`*^9, 3.608634673059718*^9, 
   3.608651083952696*^9, 3.6091745592913313`*^9, 3.609175343928527*^9, 
   3.6091754339121733`*^9, 3.6091766679432573`*^9, 3.6092345799250793`*^9, 
   3.609254836344318*^9, 3.609255532190514*^9, 3.6098387864652576`*^9, 
   3.610265586726059*^9, 3.61088366268156*^9, 3.61203325607729*^9, 
   3.612033355497954*^9, 3.612263794549322*^9, 3.612264370165822*^9, 
   3.612717138871398*^9, 3.6266211705911913`*^9, 3.626623628410284*^9, 
   3.62662524731499*^9, 3.6266341178957443`*^9, 3.626634178720167*^9, 
   3.626710509896264*^9, {3.626712279702787*^9, 3.626712314752426*^9}, {
   3.626717351900861*^9, 3.626717370104499*^9}, 3.626717441695506*^9, 
   3.626721113725007*^9, 3.6267709666231003`*^9, 3.6267712962762012`*^9, 
   3.626771362816375*^9, 3.6267713972918997`*^9, 3.626797335552199*^9, 
   3.6267983295339203`*^9, 3.626799257890272*^9, 3.627383619149337*^9, 
   3.627738104123044*^9, 3.6279913393526697`*^9, 3.629726982243128*^9, 
   3.6301581100495453`*^9, 3.6316211848094397`*^9, 3.631895976591558*^9, 
   3.632595192511201*^9, 3.632658824938805*^9, 3.635847768745534*^9, 
   3.6358724798712063`*^9, 3.636812770469646*^9, 3.636813347563792*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Consider", " ", "Shi", " ", "Eqn", " ", "7"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"u2bar", " ", "=", " ", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"za", "[", 
             RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}], "/", "2"}],
           "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "6"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"h", "[", 
               RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], "-", 
             RowBox[{
              RowBox[{"h", "[", 
               RowBox[{"x", ",", "y"}], "]"}], " ", 
              RowBox[{"zeta", "[", 
               RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"zeta", "[", 
               RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}]}], 
            ")"}]}]}], ")"}], " ", "GshiB"}], "+", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"za", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"h", "[", 
              RowBox[{"x", ",", "y"}], "]"}], "-", 
             RowBox[{"zeta", "[", 
              RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}]}]}], ")"}], 
        "GshiA"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Eqn7", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"u2bar", "-", 
      RowBox[{
       RowBox[{"Integrate", "[", 
        RowBox[{"u2", ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", 
           RowBox[{"-", 
            RowBox[{"h", "[", 
             RowBox[{"x", ",", "y"}], "]"}]}], ",", 
           RowBox[{"zeta", "[", 
            RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "}"}]}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"h", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "+", 
         RowBox[{"zeta", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}]}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.608631330092716*^9, 3.608631398119452*^9}, {
  3.608631455236907*^9, 3.608631519303608*^9}, {3.608631552629877*^9, 
  3.608631588200234*^9}, {3.60863162180541*^9, 3.608631731756721*^9}, {
  3.608632693933835*^9, 3.6086326986786213`*^9}, {3.608632979502359*^9, 
  3.6086330292673407`*^9}, {3.6086330763952093`*^9, 3.608633094046527*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.608631714556184*^9, 3.60863173324759*^9}, 
   3.608632699385825*^9, {3.608633000754986*^9, 3.608633029730414*^9}, 
   3.608633098220747*^9, 3.6086346744366503`*^9, 3.608651085256214*^9, 
   3.609174560562722*^9, 3.609175345266362*^9, 3.609175435273871*^9, 
   3.609176669233428*^9, 3.6092345812134447`*^9, 3.609254837639514*^9, 
   3.6092555335592947`*^9, 3.609838787757378*^9, 3.6102655880143137`*^9, 
   3.610883663965024*^9, 3.612033257383737*^9, 3.612033356795464*^9, 
   3.612263795858729*^9, 3.612264371482429*^9, 3.6127171402488127`*^9, 
   3.626621171913542*^9, 3.626623629705146*^9, 3.6266252486098557`*^9, 
   3.626634119188611*^9, 3.626634179995104*^9, 3.626710511244986*^9, 
   3.626721115018271*^9, 3.626770967905067*^9, 3.6267713640928288`*^9, 
   3.626797336894244*^9, 3.626798330805187*^9, 3.6267992591861773`*^9, 
   3.627383620459674*^9, 3.6277381054229507`*^9, 3.627991340666692*^9, 
   3.629726983562183*^9, 3.63015811140812*^9, 3.6316211861407633`*^9, 
   3.631895977946453*^9, 3.6325951938433313`*^9, 3.632658826246194*^9, 
   3.635847770091443*^9, 3.635872481158242*^9, 3.636812771773156*^9, 
   3.636813348867524*^9},
 FontSize->14]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"u2bar", "-", 
    RowBox[{
     RowBox[{"Integrate", "[", 
      RowBox[{
       RowBox[{"Uvec2v3", "-", "Uavec2"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{"-", 
          RowBox[{"h", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}], ",", 
         RowBox[{"zeta", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], "}"}]}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "+", 
       RowBox[{"zeta", "[", 
        RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}]}]}], " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mu", "\[Rule]", "1"}], ",", 
     RowBox[{"eps", "\[Rule]", "1"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.626711874426834*^9, 3.626711909218096*^9}, {
  3.6267120464074993`*^9, 3.626712067738264*^9}, {3.626712338912799*^9, 
  3.626712403415906*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.626712405730289*^9, 3.62672111670152*^9, 
  3.6267709695756617`*^9, 3.626771365773337*^9, 3.626797338668223*^9, 
  3.626798332447433*^9, 3.626799260827614*^9, 3.627383622147252*^9, 
  3.627738107112598*^9, 3.627991342325177*^9, 3.6297269852708*^9, 
  3.630158113244775*^9, 3.631621187988209*^9, 3.631895979654641*^9, 
  3.632595195613327*^9, 3.632658827972155*^9, 3.635847771851445*^9, 
  3.635872482838496*^9, 3.636812773517626*^9, 3.6368133505272217`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "The", " ", "governing", " ", "equations", " ", "as", " ", "they", " ", 
     "appear", " ", "in", " ", 
     RowBox[{"Dr", ".", " ", 
      RowBox[{"Shi", "'"}]}], "s", " ", 
     RowBox[{"manual", ".", " ", "However"}]}], ",", " ", 
    RowBox[{
    "the", " ", "vector", " ", "u2bar", " ", "was", " ", "replaced", " ", 
     "with", " ", 
     RowBox[{"u2", ".", " ", "This"}], " ", "seems", " ", "to", " ", "be", 
     " ", "a", " ", "typo", " ", "in", " ", 
     RowBox[{"Dr", ".", " ", 
      RowBox[{"Shi", "'"}]}], "s", " ", 
     RowBox[{"manual", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"u2bar3", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u2bar", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"u2bar", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Uavec3", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Uavec2", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"Uavec2", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V1shi", " ", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"za", "[", 
              RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}], "/", 
            "2"}], ")"}], " ", "GshiB"}], "+", 
         RowBox[{
          RowBox[{"za", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", "GshiA"}]}], ",", 
        "t"}], "]"}], "-", 
      RowBox[{"G2", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"zeta", "[", 
             RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}], "/", "2"}],
           " ", ")"}], 
         RowBox[{"D", "[", 
          RowBox[{"ShiB", ",", "t"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"zeta", "[", 
          RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
         RowBox[{"D", "[", 
          RowBox[{"ShiA", ",", "t"}], "]"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V2shi", " ", "=", " ", 
     RowBox[{"G2", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"za", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}], "-", 
          RowBox[{"zeta", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}], 
        RowBox[{"DG2", "[", 
         RowBox[{"Uavec2", ",", "ShiA"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"za", "[", 
            RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}], "-", 
          RowBox[{
           RowBox[{"zeta", "[", 
            RowBox[{"x", ",", "y", ",", "t"}], "]"}], "^", "2"}]}], ")"}], 
        RowBox[{"DG2", "[", 
         RowBox[{"Uavec2", ",", "ShiB"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ShiA", "+", 
           RowBox[{
            RowBox[{"zeta", "[", 
             RowBox[{"x", ",", "y", ",", "t"}], "]"}], "ShiB"}]}], ")"}], "^",
          "2"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w0", " ", "=", " ", 
     RowBox[{"Curl", "[", 
      RowBox[{"Uavec3", ",", "Coords"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w2", " ", "=", " ", 
     RowBox[{"Curl", "[", 
      RowBox[{"ushi3m", ",", "Coords"}], "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Note", " ", "the", " ", "first", " ", "term", " ", "is", " ", "added", 
      " ", "by", " ", "Chen"}], ",", " ", 
     RowBox[{"but", " ", "is", " ", "not", " ", "present", " ", "in", " ", 
      RowBox[{"Hsaio", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V3shi3", " ", "=", " ", 
     RowBox[{
      RowBox[{"mu", "^", "2"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cross", "[", 
         RowBox[{"w0", ",", "ushi3m"}], "]"}], "+", " ", 
        RowBox[{"Cross", "[", 
         RowBox[{"w2", ",", "Uavec3"}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V3shi", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"V3shi3", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"V3shi3", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GovMomShiRaw", " ", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"Uavec2", ",", "t"}], "]"}], "+", 
      RowBox[{"DG2", "[", 
       RowBox[{"Uavec2", ",", "Uavec2"}], "]"}], "+", 
      RowBox[{"g", " ", 
       RowBox[{"G2", "[", 
        RowBox[{"zeta", "[", 
         RowBox[{"x", ",", "y", ",", "t"}], "]"}], "]"}]}], "+", "V1shi", "+",
       "V2shi", "+", "V3shi"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GovMomShi", " ", "=", " ", 
     RowBox[{"Normal", "[", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "GovMomShiRaw", ")"}], " ", "/.", " ", 
         RowBox[{"z", "\[Rule]", 
          RowBox[{"za", "[", 
           RowBox[{"x", ",", "y", ",", "t"}], "]"}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{"mu", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.608632490037994*^9, 3.608632627544695*^9}, {
   3.6086327072145357`*^9, 3.6086328615154457`*^9}, {3.608632914355345*^9, 
   3.608632963252048*^9}, {3.6086331051853456`*^9, 3.608633399395813*^9}, {
   3.6086334326546717`*^9, 3.608633515604311*^9}, {3.6086338287513437`*^9, 
   3.60863383103494*^9}, {3.60863468973297*^9, 3.608634703019938*^9}, {
   3.609176718330308*^9, 3.6091767396362762`*^9}, {3.609176807171958*^9, 
   3.609176866424326*^9}, {3.6091769099419603`*^9, 3.609176916783258*^9}, {
   3.60917706975877*^9, 3.609177153716826*^9}, {3.609177192687241*^9, 
   3.609177261295558*^9}, {3.60917760278515*^9, 3.609177603176402*^9}, 
   3.609177650930623*^9, {3.609177695804356*^9, 3.609177716141305*^9}, {
   3.609177748152466*^9, 3.609177828951537*^9}, {3.609177934741819*^9, 
   3.609178186238113*^9}, {3.609178216731024*^9, 3.609178252498186*^9}, {
   3.6091784830028067`*^9, 3.609178497059916*^9}, {3.609178606159943*^9, 
   3.609178648833221*^9}, {3.609178814448902*^9, 3.6091788174260693`*^9}, {
   3.609178850914768*^9, 3.609178851060988*^9}, {3.609178919518282*^9, 
   3.609178921869371*^9}, {3.609178987916655*^9, 3.609178990361467*^9}, {
   3.609179119523953*^9, 3.609179119684462*^9}, {3.609179164887824*^9, 
   3.609179171963118*^9}, 3.609179209284402*^9, {3.609179245607583*^9, 
   3.609179256621133*^9}, {3.6091792882166443`*^9, 3.609179307806077*^9}, {
   3.609179347126974*^9, 3.609179372807501*^9}, {3.60917948072326*^9, 
   3.609179484310899*^9}, 3.609179536290213*^9, 3.6092400962480717`*^9, {
   3.612718695575983*^9, 3.61271869572362*^9}, {3.61271876112179*^9, 
   3.612718761255056*^9}, {3.6127188603589163`*^9, 3.612718860860396*^9}, {
   3.612719045417864*^9, 3.61271904552*^9}, {3.612719125855233*^9, 
   3.612719126049137*^9}, {3.626625922860979*^9, 3.626625923454163*^9}, {
   3.6266259824294767`*^9, 3.626626015135091*^9}, {3.626626048987812*^9, 
   3.626626061963298*^9}, {3.626632613182015*^9, 3.626632613382574*^9}, {
   3.626632893293912*^9, 3.6266328934325657`*^9}, {3.6266341347951803`*^9, 
   3.626634134915482*^9}, {3.626634189587068*^9, 3.626634189710187*^9}, {
   3.626710965021471*^9, 3.6267109654771442`*^9}, {3.626712991562315*^9, 
   3.626712991690237*^9}, {3.6267162060433607`*^9, 3.626716206249237*^9}, {
   3.626716607668689*^9, 3.626716640723185*^9}, {3.626717012894691*^9, 
   3.626717014101027*^9}, {3.626717110851446*^9, 3.626717114399832*^9}, {
   3.6267174532057753`*^9, 3.626717521056834*^9}, {3.6267175915059767`*^9, 
   3.626717636122164*^9}, 3.626771308891385*^9, 3.626771440110648*^9, {
   3.6267714753017406`*^9, 3.626771481476468*^9}, {3.626797408978981*^9, 
   3.6267974527702436`*^9}, {3.6267976218926287`*^9, 3.626797654778796*^9}, {
   3.6267991852904673`*^9, 3.6267992444160223`*^9}, 3.632595298276129*^9},
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DG2", "[", 
  RowBox[{"Uavec2", ",", "ShiB"}], "]"}]], "Input",
 CellChangeTimes->{{3.6326589969389153`*^9, 3.632659004305266*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"va", "[", 
    RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["va", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "2", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "t"}], "]"}], "+", 
     RowBox[{
      SuperscriptBox["ua", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"ua", "[", 
    RowBox[{"x", ",", "y", ",", "t"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["va", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "t"}], "]"}], "+", 
     RowBox[{
      SuperscriptBox["ua", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"2", ",", "0", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y", ",", "t"}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.632659004968976*^9, 3.635847772237708*^9, 
  3.635872483226296*^9, 3.636812773883706*^9, 3.636813350797563*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Dr", ".", " ", 
    RowBox[{"Shi", "'"}]}], "s", " ", "result", " ", "agrees", " ", "with", 
   " ", "Hsaio", " ", "2002", " ", "if", " ", "you", " ", "set", " ", "the", 
   " ", "constants", " ", "to", " ", "1"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.636813237102694*^9, 3.636813262379551*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"GovMomRaw", "  ", "-", " ", "GovMomShiRaw"}], " ", ")"}], " ", "/.",
    " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mu", "\[Rule]", "1"}], ",", 
     RowBox[{"eps", "\[Rule]", "1"}], ",", 
     RowBox[{"g", "\[Rule]", "1"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.632596462390697*^9, 3.632596482469946*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.632596483679682*^9, 3.632658828432559*^9, 
  3.63584777232295*^9, 3.635872483325294*^9, 3.63681277401289*^9, 
  3.6368133508944607`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"GovMom", "  ", "-", " ", "GovMomShi"}], " ", ")"}], " ", "/.", 
   " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"mu", "\[Rule]", "1"}], ",", 
     RowBox[{"eps", "\[Rule]", "1"}], ",", 
     RowBox[{"g", "\[Rule]", "1"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6091794996185827`*^9, 3.609179524716374*^9}, {
   3.612718719117669*^9, 3.612718719729124*^9}, 3.61271875401514*^9, {
   3.626632518410627*^9, 3.626632573485338*^9}, 3.62663264884299*^9, {
   3.626632725575111*^9, 3.626632740009869*^9}, {3.626632775779439*^9, 
   3.626632792724527*^9}, {3.6266341395804*^9, 3.6266341428679237`*^9}, {
   3.626771179621895*^9, 3.6267711857491693`*^9}, {3.626798207247569*^9, 
   3.626798207777091*^9}, {3.6267982641183987`*^9, 3.626798302500888*^9}, {
   3.6316212625744667`*^9, 3.6316212649822607`*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.632658828474043*^9, 3.635847772354784*^9, 
  3.6358724833698807`*^9, 3.6368127740783*^9, 3.636813350941267*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox["(*", "Input"], " ", 
   RowBox[{
    RowBox[{"In", " ", "case", " ", 
     RowBox[{"it", "'"}], "s", " ", "of", " ", "interest"}], ",", " ", 
    RowBox[{
     RowBox[{
     "these", " ", "two", " ", "versions", " ", "of", " ", "the", " ", 
      "Euler", " ", "Eqns", " ", "are", " ", "the", " ", "same", " ", "if", 
      " ", 
      RowBox[{"Div", "[", "u", "]"}]}], " ", "=", " ", "0"}]}], " ", "*)"}], 
  StyleBox["\[IndentingNewLine]", "Input"], 
  RowBox[{
   StyleBox[
    RowBox[{
     RowBox[{"uv", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ux", "[", 
         RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
        RowBox[{"uy", "[", 
         RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
        RowBox[{"uz", "[", 
         RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "}"}]}], ";"}], "Input"], 
   StyleBox["\[LineSeparator]", "Input"], 
   StyleBox[
    RowBox[{
     RowBox[{"euler1", "=", 
      RowBox[{
       RowBox[{"Grad", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"uv", ".", "uv"}], "/", "2"}], ",", "Coords"}], "]"}], "+", 
       
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{"Curl", "[", 
          RowBox[{"uv", ",", "Coords"}], "]"}], ",", "uv"}], "]"}]}]}], ";"}],
     "Input"], 
   StyleBox["\[IndentingNewLine]", "Input"], 
   RowBox[{
    RowBox[{
     StyleBox["euler2", "Input"], 
     StyleBox["=", "Input"], 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"uv", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", 
            RowBox[{"uv", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ",", 
           RowBox[{"Coords", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zero", " ", "=", 
     RowBox[{"Div", "[", 
      RowBox[{"uv", ",", "Coords"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"(", 
     RowBox[{"euler1", "-", "euler2", " ", "+", " ", 
      RowBox[{"uv", " ", "zero"}]}], ")"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.609237107832589*^9, 3.609237218716394*^9}, {
  3.609237251374721*^9, 3.6092373923051643`*^9}, {3.6092374308054953`*^9, 
  3.609237482154636*^9}, {3.609237656194742*^9, 3.6092376620771933`*^9}, {
  3.609237960609394*^9, 3.609237963595955*^9}, {3.609238164866878*^9, 
  3.609238181293318*^9}, {3.609239410084301*^9, 3.609239497744575*^9}, {
  3.609239836459629*^9, 3.609239846620986*^9}, {3.626626293463501*^9, 
  3.626626293647993*^9}, {3.626630740743376*^9, 3.626630742693013*^9}, {
  3.636813301318351*^9, 3.636813306123535*^9}},
 FontSize->14],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.609237380429933*^9, 3.60923739372005*^9}, {
   3.609237435792625*^9, 3.609237482831194*^9}, {3.609237656911076*^9, 
   3.609237662864572*^9}, 3.609238182307911*^9, {3.609239415338056*^9, 
   3.609239453776761*^9}, 3.609239498312687*^9, 3.609239848809984*^9, 
   3.609254838142827*^9, 3.609255533784644*^9, 3.609838788033825*^9, 
   3.61026558823118*^9, 3.6108836643207407`*^9, 3.6120332575996447`*^9, 
   3.6120333570334997`*^9, 3.6122637961918983`*^9, 3.612264371717771*^9, 
   3.612717140624949*^9, 3.6266211722476873`*^9, 3.626623630022882*^9, 
   3.626625248874872*^9, 3.626625949297943*^9, 3.62662629437947*^9, 
   3.626634119370872*^9, 3.6266341803068733`*^9, 3.626710511482396*^9, 
   3.626719852838943*^9, 3.6267211173227663`*^9, 3.6267709703741417`*^9, 
   3.626771366142684*^9, 3.62679733922717*^9, 3.626798333030982*^9, 
   3.626799261186718*^9, 3.627383622583742*^9, 3.627738107568769*^9, 
   3.6279913427582073`*^9, 3.629726985729322*^9, 3.6301581137853107`*^9, 
   3.6316211886271477`*^9, 3.631895980141945*^9, 3.632595196047955*^9, 
   3.632658833301571*^9, 3.635847777330755*^9, 3.635872488394806*^9, 
   3.636812779182027*^9, 3.63681335098166*^9},
 FontSize->14]
}, Open  ]]
},
WindowSize->{2048, 1096},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (November 20, 2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 1937, 48, 297, "Input"],
Cell[2497, 70, 4509, 118, 209, "Input"],
Cell[7009, 190, 1513, 36, 77, "Input"],
Cell[CellGroupData[{
Cell[8547, 230, 631, 16, 32, "Input"],
Cell[9181, 248, 1371, 38, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10589, 291, 1051, 28, 77, "Input"],
Cell[11643, 321, 2235, 50, 35, "Output"]
}, Open  ]],
Cell[13893, 374, 708, 20, 55, "Input"],
Cell[14604, 396, 809, 23, 77, "Input"],
Cell[15416, 421, 1540, 40, 55, "Input"],
Cell[CellGroupData[{
Cell[16981, 465, 1302, 34, 77, "Input"],
Cell[18286, 501, 3181, 75, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21504, 581, 865, 24, 55, "Input"],
Cell[22372, 607, 3046, 74, 54, "Output"]
}, Open  ]],
Cell[25433, 684, 2107, 58, 165, "Input"],
Cell[CellGroupData[{
Cell[27565, 746, 1656, 38, 55, "Input"],
Cell[29224, 786, 5430, 141, 101, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34691, 932, 335, 8, 32, "Input"],
Cell[35029, 942, 1601, 25, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36667, 972, 682, 15, 32, "Input"],
Cell[37352, 989, 3332, 80, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40721, 1074, 1273, 37, 32, "Input"],
Cell[41997, 1113, 3239, 82, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45273, 1200, 178, 4, 32, "Input"],
Cell[45454, 1206, 1547, 22, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47038, 1233, 2081, 52, 55, "Input"],
Cell[49122, 1287, 2720, 60, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51879, 1352, 2547, 60, 121, "Input"],
Cell[54429, 1414, 2737, 58, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57203, 1477, 2748, 69, 209, "Input"],
Cell[59954, 1548, 3559, 99, 37, "Output"],
Cell[63516, 1649, 1622, 35, 37, "Output"],
Cell[65141, 1686, 2726, 71, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67904, 1762, 509, 14, 55, "Input"],
Cell[68416, 1778, 1579, 38, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70032, 1821, 3073, 72, 187, "Input"],
Cell[73108, 1895, 1498, 36, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74643, 1936, 3331, 80, 165, "Input"],
Cell[77977, 2018, 9166, 265, 153, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87180, 2288, 1114, 29, 55, "Input"],
Cell[88297, 2319, 1590, 25, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89924, 2349, 3152, 76, 143, "Input"],
Cell[93079, 2427, 10179, 309, 153, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103295, 2741, 770, 24, 55, "Input"],
Cell[104068, 2767, 1412, 22, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105517, 2794, 1298, 38, 55, "Input"],
Cell[106818, 2834, 676, 14, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107531, 2853, 325, 9, 32, "Input"],
Cell[107859, 2864, 8206, 250, 148, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116102, 3119, 2181, 56, 99, "Input"],
Cell[118286, 3177, 17256, 481, 209, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135579, 3663, 1773, 48, 32, "Input"],
Cell[137355, 3713, 9784, 304, 153, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147176, 4022, 538, 11, 32, "Input"],
Cell[147717, 4035, 1724, 27, 32, "Output"]
}, Open  ]],
Cell[149456, 4065, 2412, 57, 99, "Input"],
Cell[151871, 4124, 3183, 79, 77, "Input"],
Cell[CellGroupData[{
Cell[155079, 4207, 876, 16, 55, "Input"],
Cell[155958, 4225, 2344, 34, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158339, 4264, 4004, 92, 231, "Input"],
Cell[162346, 4358, 3108, 73, 37, "Output"]
}, Open  ]],
Cell[165469, 4434, 2754, 59, 121, "Input"],
Cell[168226, 4495, 791, 20, 55, "Input"],
Cell[169020, 4517, 3841, 105, 165, "Input"],
Cell[CellGroupData[{
Cell[172886, 4626, 245, 5, 32, "Input"],
Cell[173134, 4633, 1701, 25, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[174872, 4663, 867, 23, 55, "Input"],
Cell[175742, 4688, 2650, 64, 39, "Output"]
}, Open  ]],
Cell[178407, 4755, 1314, 35, 77, "Input"],
Cell[179724, 4792, 4555, 94, 275, "Input"],
Cell[184282, 4888, 508, 14, 32, "Input"],
Cell[CellGroupData[{
Cell[184815, 4906, 230, 4, 32, "Input"],
Cell[185048, 4912, 387, 5, 32, "Output"]
}, Open  ]],
Cell[185450, 4920, 894, 26, 55, "Input"],
Cell[186347, 4948, 1140, 25, 77, "Input"],
Cell[187490, 4975, 399, 8, 32, "Input"],
Cell[CellGroupData[{
Cell[187914, 4987, 7581, 197, 297, "Input"],
Cell[195498, 5186, 1822, 27, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197357, 5218, 3285, 89, 253, "Input"],
Cell[200645, 5309, 1380, 21, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202062, 5335, 2745, 75, 121, "Input"],
Cell[204810, 5412, 1252, 20, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[206099, 5437, 964, 27, 32, "Input"],
Cell[207066, 5466, 552, 9, 32, "Output"]
}, Open  ]],
Cell[207633, 5478, 8547, 207, 275, "Input"],
Cell[CellGroupData[{
Cell[216205, 5689, 155, 3, 32, "Input"],
Cell[216363, 5694, 1393, 45, 37, "Output"]
}, Open  ]],
Cell[217771, 5742, 361, 7, 32, "Input"],
Cell[CellGroupData[{
Cell[218157, 5753, 407, 11, 32, "Input"],
Cell[218567, 5766, 231, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[218835, 5776, 910, 19, 32, "Input"],
Cell[219748, 5797, 206, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219991, 5806, 3007, 81, 187, "Input"],
Cell[223001, 5889, 1285, 20, 65, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
